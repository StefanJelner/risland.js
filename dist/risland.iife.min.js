/**
 * @license
 * author: Stefan Jelner
 * risland.js v0.0.1
 * Released under the ISC license.
 * 
 * See https://github.com/StefanJelner/risland.js.git
 */
var RIsland=function(){"use strict";function e(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var o=Object.prototype.toString,a=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var r,n=t(e);if("boolean"===n)return"boolean";if("string"===n)return"string";if("number"===n)return"number";if("symbol"===n)return"symbol";if("function"===n)return r=e,"GeneratorFunction"===i(r)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}
/*!
   * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
   *
   * Copyright (c) 2015-present, Jon Schlinkert.
   * Released under the MIT License.
   */(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(i(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(n=o.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return n.slice(8,-1).toLowerCase().replace(/\s/g,"")};function i(e){return"function"==typeof e.constructor?e.constructor.name:null}var c=Symbol.prototype.valueOf,u=a;var s=function(e){return null!=e&&"object"===t(e)&&!1===Array.isArray(e)};function l(e){return!0===s(e)&&"[object Object]"===Object.prototype.toString.call(e)}var f=function(e,t){switch(u(e)){case"array":return e.slice();case"object":return Object.assign({},e);case"date":return new e.constructor(Number(e));case"map":return new Map(e);case"set":return new Set(e);case"buffer":return function(e){var t=e.length,r=Buffer.allocUnsafe?Buffer.allocUnsafe(t):Buffer.from(t);return e.copy(r),r}(e);case"symbol":return function(e){return c?Object(c.call(e)):{}}(e);case"arraybuffer":return function(e){var t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}(e);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return function(e,t){return new e.constructor(e.buffer,e.byteOffset,e.length)}(e);case"regexp":return function(e){var t=void 0!==e.flags?e.flags:/\w+$/.exec(e)||void 0,r=new e.constructor(e.source,t);return r.lastIndex=e.lastIndex,r}(e);case"error":return Object.create(e);default:return e}},d=a,p=function(e){var t,r;return!1!==l(e)&&("function"==typeof(t=e.constructor)&&(!1!==l(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))};function h(e,t){switch(d(e)){case"object":return function(e,t){if("function"==typeof t)return t(e);if(t||p(e)){var r=new e.constructor;for(var n in e)r[n]=h(e[n],t);return r}return e}(e,t);case"array":return function(e,t){for(var r=new e.constructor(e.length),n=0;n<e.length;n++)r[n]=h(e[n],t);return r}(e,t);default:return f(e)}}var g=h,m=function(e){return function(e){return!!e&&"object"===t(e)}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===y}(e)}(e)};var y="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function v(e,t){return!1!==t.clone&&t.isMergeableObject(e)?x((r=e,Array.isArray(r)?[]:{}),e,t):e;var r}function b(e,t,r){return e.concat(t).map((function(e){return v(e,r)}))}function _(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function w(e,t){try{return t in e}catch(e){return!1}}function O(e,t,r){var n={};return r.isMergeableObject(e)&&_(e).forEach((function(t){n[t]=v(e[t],r)})),_(t).forEach((function(o){(function(e,t){return w(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(w(e,o)&&r.isMergeableObject(t[o])?n[o]=function(e,t){if(!t.customMerge)return x;var r=t.customMerge(e);return"function"==typeof r?r:x}(o,r)(e[o],t[o],r):n[o]=v(t[o],r))})),n}function x(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||b,r.isMergeableObject=r.isMergeableObject||m,r.cloneUnlessOtherwiseSpecified=v;var n=Array.isArray(t);return n===Array.isArray(e)?n?r.arrayMerge(e,t,r):O(e,t,r):v(t,r)}x.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,r){return x(e,r,t)}),{})};var S=x,A=function e(r,n){if(r===n)return!0;if(r&&n&&"object"==t(r)&&"object"==t(n)){if(r.constructor!==n.constructor)return!1;var o,a,i;if(Array.isArray(r)){if((o=r.length)!=n.length)return!1;for(a=o;0!=a--;)if(!e(r[a],n[a]))return!1;return!0}if(r.constructor===RegExp)return r.source===n.source&&r.flags===n.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===n.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===n.toString();if((o=(i=Object.keys(r)).length)!==Object.keys(n).length)return!1;for(a=o;0!=a--;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=o;0!=a--;){var c=i[a];if(!e(r[c],n[c]))return!1}return!0}return r!=r&&n!=n};
/*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   */
function N(e){return"[object Object]"===Object.prototype.toString.call(e)}function j(e){var t,r;return!1!==N(e)&&(void 0===(t=e.constructor)||!1!==N(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf"))}var E;var T="undefined"==typeof document?void 0:document,C=!!T&&"content"in T.createElement("template"),I=!!T&&T.createRange&&"createContextualFragment"in T.createRange();function U(e){return e=e.trim(),C?function(e){var t=T.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(e):I?function(e){return E||(E=T.createRange()).selectNode(T.body),E.createContextualFragment(e).childNodes[0]}(e):function(e){var t=T.createElement("body");return t.innerHTML=e,t.childNodes[0]}(e)}function R(e,t){var r,n,o=e.nodeName,a=t.nodeName;return o===a||(r=o.charCodeAt(0),n=a.charCodeAt(0),r<=90&&n>=97?o===a.toUpperCase():n<=90&&r>=97&&a===o.toUpperCase())}function F(e,t,r){e[r]!==t[r]&&(e[r]=t[r],e[r]?e.setAttribute(r,""):e.removeAttribute(r))}var P={OPTION:function(e,t){var r=e.parentNode;if(r){var n=r.nodeName.toUpperCase();"OPTGROUP"===n&&(n=(r=r.parentNode)&&r.nodeName.toUpperCase()),"SELECT"!==n||r.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),r.selectedIndex=-1)}F(e,t,"selected")},INPUT:function(e,t){F(e,t,"checked"),F(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var r=t.value;e.value!==r&&(e.value=r);var n=e.firstChild;if(n){var o=n.nodeValue;if(o==r||!r&&o==e.placeholder)return;n.nodeValue=r}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var r,n,o=-1,a=0,i=e.firstChild;i;)if("OPTGROUP"===(n=i.nodeName&&i.nodeName.toUpperCase()))i=(r=i).firstChild;else{if("OPTION"===n){if(i.hasAttribute("selected")){o=a;break}a++}!(i=i.nextSibling)&&r&&(i=r.nextSibling,r=null)}e.selectedIndex=o}}};function M(){}function k(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var B=function(e){return function(t,r,n){if(n||(n={}),"string"==typeof r)if("#document"===t.nodeName||"HTML"===t.nodeName||"BODY"===t.nodeName){var o=r;(r=T.createElement("html")).innerHTML=o}else r=U(r);var a=n.getNodeKey||k,i=n.onBeforeNodeAdded||M,c=n.onNodeAdded||M,u=n.onBeforeElUpdated||M,s=n.onElUpdated||M,l=n.onBeforeNodeDiscarded||M,f=n.onNodeDiscarded||M,d=n.onBeforeElChildrenUpdated||M,p=!0===n.childrenOnly,h=Object.create(null),g=[];function m(e){g.push(e)}function y(e,t){if(1===e.nodeType)for(var r=e.firstChild;r;){var n=void 0;t&&(n=a(r))?m(n):(f(r),r.firstChild&&y(r,t)),r=r.nextSibling}}function v(e,t,r){!1!==l(e)&&(t&&t.removeChild(e),f(e),y(e,r))}function b(e){c(e);for(var t=e.firstChild;t;){var r=t.nextSibling,n=a(t);if(n){var o=h[n];o&&R(t,o)?(t.parentNode.replaceChild(o,t),_(o,t)):b(t)}else b(t);t=r}}function _(t,r,n){var o=a(r);if(o&&delete h[o],!n){if(!1===u(t,r))return;if(e(t,r),s(t),!1===d(t,r))return}"TEXTAREA"!==t.nodeName?function(e,t){var r,n,o,c,u,s=t.firstChild,l=e.firstChild;e:for(;s;){for(c=s.nextSibling,r=a(s);l;){if(o=l.nextSibling,s.isSameNode&&s.isSameNode(l)){s=c,l=o;continue e}n=a(l);var f=l.nodeType,d=void 0;if(f===s.nodeType&&(1===f?(r?r!==n&&((u=h[r])?o===u?d=!1:(e.insertBefore(u,l),n?m(n):v(l,e,!0),l=u):d=!1):n&&(d=!1),(d=!1!==d&&R(l,s))&&_(l,s)):3!==f&&8!=f||(d=!0,l.nodeValue!==s.nodeValue&&(l.nodeValue=s.nodeValue))),d){s=c,l=o;continue e}n?m(n):v(l,e,!0),l=o}if(r&&(u=h[r])&&R(u,s))e.appendChild(u),_(u,s);else{var p=i(s);!1!==p&&(p&&(s=p),s.actualize&&(s=s.actualize(e.ownerDocument||T)),e.appendChild(s),b(s))}s=c,l=o}!function(e,t,r){for(;t;){var n=t.nextSibling;(r=a(t))?m(r):v(t,e,!0),t=n}}(e,l,n);var g=P[e.nodeName];g&&g(e,t)}(t,r):P.TEXTAREA(t,r)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var r=t.firstChild;r;){var n=a(r);n&&(h[n]=r),e(r),r=r.nextSibling}}(t);var w,O,x=t,S=x.nodeType,A=r.nodeType;if(!p)if(1===S)1===A?R(t,r)||(f(t),x=function(e,t){for(var r=e.firstChild;r;){var n=r.nextSibling;t.appendChild(r),r=n}return t}(t,(w=r.nodeName,(O=r.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==O?T.createElementNS(O,w):T.createElement(w)))):x=r;else if(3===S||8===S){if(A===S)return x.nodeValue!==r.nodeValue&&(x.nodeValue=r.nodeValue),x;x=r}if(x===r)f(t);else{if(r.isSameNode&&r.isSameNode(x))return;if(_(x,r,p),g)for(var N=0,j=g.length;N<j;N++){var E=h[g[N]];E&&v(E,E.parentNode,!1)}}return!p&&x!==t&&t.parentNode&&(x.actualize&&(x=x.actualize(t.ownerDocument||T)),t.parentNode.replaceChild(x,t)),x}}((function(e,t){var r,n,o,a,i=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var c=i.length-1;c>=0;c--)n=(r=i[c]).name,o=r.namespaceURI,a=r.value,o?(n=r.localName||n,e.getAttributeNS(o,n)!==a&&("xmlns"===r.prefix&&(n=r.name),e.setAttributeNS(o,n,a))):e.getAttribute(n)!==a&&e.setAttribute(n,a);for(var u=e.attributes,s=u.length-1;s>=0;s--)n=(r=u[s]).name,(o=r.namespaceURI)?(n=r.localName||n,t.hasAttributeNS(o,n)||e.removeAttributeNS(o,n)):t.hasAttribute(n)||e.removeAttribute(n)}})),L=function(e){var t,r=null,n=function(n){return function(){r=null,e.apply(n,t)}},o=function(){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];t=o,null===r&&(r=requestAnimationFrame(n(this)))};return o.cancel=function(){cancelAnimationFrame(r),r=null},o},H={exports:{}};(function(e){function r(e){var t,n,o=new Error(e);return t=o,n=r.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n,o}function n(e,t,n){var o=t.slice(0,n).split(/\n/),a=o.length,i=o[a-1].length+1;throw r(e+=" at line "+a+" col "+i+":\n\n  "+t.split(/\n/)[a-1]+"\n  "+Array(i).join(" ")+"^")}r.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var o=new Function("return this")().Promise,a=!1;try{a=new Function("return (async function(){}).constructor")()}catch(e){if(!(e instanceof SyntaxError))throw e}function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,r,n){for(var o in r)i(r,o)&&(null==r[o]||"object"!=t(r[o])||"storage"!==o&&"prefixes"!==o||n?e[o]=r[o]:e[o]=c({},r[o]));return e}var u=/^async +/,s=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,l=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,f=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g,d=/[.*+\-?^${}()|[\]\\]/g;function p(e){return d.test(e)?e.replace(d,"\\$&"):e}function h(e,t){t.rmWhitespace&&(e=e.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),s.lastIndex=0,l.lastIndex=0,f.lastIndex=0;var o=t.prefixes,a=[o.h,o.b,o.i,o.r,o.c,o.e].reduce((function(e,t){return e&&t?e+"|"+p(t):t?p(t):e}),""),i=new RegExp("([|()]|=>)|('|\"|`|\\/\\*)|\\s*((\\/)?(-|_)?"+p(t.tags[1])+")","g"),c=new RegExp("([^]*?)"+p(t.tags[0])+"(-|_)?\\s*("+a+")?\\s*","g"),d=0,h=!1;function g(r,o){var a,p={f:[]},g=0,m="c";function y(r){var o=e.slice(d,r),a=o.trim();if("f"===m)"safe"===a?p.raw=!0:t.async&&u.test(a)?(a=a.replace(u,""),p.f.push([a,"",!0])):p.f.push([a,""]);else if("fp"===m)p.f[p.f.length-1][1]+=a;else if("err"===m){if(a){var i=o.search(/\S/);n("invalid syntax",e,d+i)}}else p[m]=a;d=r+1}for("h"===o||"b"===o||"c"===o?m="n":"r"===o&&(p.raw=!0,o="i"),i.lastIndex=d;null!==(a=i.exec(e));){var v=a[1],b=a[2],_=a[3],w=a[4],O=a[5],x=a.index;if(v)"("===v?(0===g&&("n"===m?(y(x),m="p"):"f"===m&&(y(x),m="fp")),g++):")"===v?0==--g&&"c"!==m&&(y(x),m="err"):0===g&&"|"===v?(y(x),m="f"):"=>"===v&&(y(x),d+=1,m="res");else if(b)if("/*"===b){var S=e.indexOf("*/",i.lastIndex);-1===S&&n("unclosed comment",e,a.index),i.lastIndex=S+2}else"'"===b?(l.lastIndex=a.index,l.exec(e)?i.lastIndex=l.lastIndex:n("unclosed string",e,a.index)):'"'===b?(f.lastIndex=a.index,f.exec(e)?i.lastIndex=f.lastIndex:n("unclosed string",e,a.index)):"`"===b&&(s.lastIndex=a.index,s.exec(e)?i.lastIndex=s.lastIndex:n("unclosed string",e,a.index));else if(_)return y(x),d=x+a[0].length,c.lastIndex=d,h=O,w&&"h"===o&&(o="s"),p.t=o,p}return n("unclosed tag",e,r),p}var m=function a(i,s){i.b=[],i.d=[];var l,f=!1,p=[];function m(e,r){e&&(e=function(e,t,r,n){var o,a;return"string"==typeof t.autoTrim?o=a=t.autoTrim:Array.isArray(t.autoTrim)&&(o=t.autoTrim[1],a=t.autoTrim[0]),(r||!1===r)&&(o=r),(n||!1===n)&&(a=n),"slurp"===o&&"slurp"===a?e.trim():("_"===o||"slurp"===o?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==o&&"nl"!==o||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===a||"slurp"===a?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==a&&"nl"!==a||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(e,t,h,r))&&(e=e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),p.push(e))}for(;null!==(l=c.exec(e));){var y,v=l[1],b=l[2],_=l[3]||"";for(var w in o)if(o[w]===_){y=w;break}m(v,b),d=l.index+l[0].length,y||n("unrecognized tag type: "+_,e,d);var O=g(l.index,y),x=O.t;if("h"===x){var S=O.n||"";t.async&&u.test(S)&&(O.a=!0,O.n=S.replace(u,"")),O=a(O),p.push(O)}else if("c"===x){if(i.n===O.n)return f?(f.d=p,i.b.push(f)):i.d=p,i;n("Helper start and end don't match",e,l.index+l[0].length)}else if("b"===x){f?(f.d=p,i.b.push(f)):i.d=p;var A=O.n||"";t.async&&u.test(A)&&(O.a=!0,O.n=A.replace(u,"")),f=O,p=[]}else if("s"===x){var N=O.n||"";t.async&&u.test(N)&&(O.a=!0,O.n=N.replace(u,"")),p.push(O)}else p.push(O)}if(!s)throw r('unclosed helper "'+i.n+'"');return m(e.slice(d,e.length),!1),i.d=p,i}({f:[]},!0);if(t.plugins)for(var y=0;y<t.plugins.length;y++){var v=t.plugins[y];v.processAST&&(m.d=v.processAST(m.d,t))}return m.d}function g(e,t){var r=h(e,t),n="var tR='';"+(t.useWith?"with("+t.varName+"||{}){":"")+_(r,t)+"if(cb){cb(null,tR)} return tR"+(t.useWith?"}":"");if(t.plugins)for(var o=0;o<t.plugins.length;o++){var a=t.plugins[o];a.processFnString&&(n=a.processFnString(n,t))}return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r][0],o=t[r][1];e=(t[r][2]?"await ":"")+"c.l('F','"+n+"')("+e,o&&(e+=","+o),e+=")"}return e}function y(e,t,r,n,o,a){var i="{exec:"+(o?"async ":"")+b(r,t,e)+",params:["+n+"]";return a&&(i+=",name:'"+a+"'"),o&&(i+=",async:true"),i+"}"}function v(e,t){for(var r="[",n=0;n<e.length;n++){var o=e[n];r+=y(t,o.res||"",o.d,o.p||"",o.a,o.n),n<e.length&&(r+=",")}return r+"]"}function b(e,t,r){return"function("+t+"){var tR='';"+_(e,r)+"return tR}"}function _(e,t){for(var r=0,n=e.length,o="";r<n;r++){var a=e[r];if("string"==typeof a)o+="tR+='"+a+"';";else{var i=a.t,c=a.c||"",u=a.f,s=a.n||"",l=a.p||"",f=a.res||"",d=a.b,p=!!a.a;if("i"===i){t.defaultFilter&&(c="c.l('F','"+t.defaultFilter+"')("+c+")");var h=m(c,u);!a.raw&&t.autoEscape&&(h="c.l('F','e')("+h+")"),o+="tR+="+h+";"}else if("h"===i)if(t.storage.nativeHelpers.get(s))o+=t.storage.nativeHelpers.get(s)(a,t);else{var g=(p?"await ":"")+"c.l('H','"+s+"')("+y(t,f,a.d,l,p);g+=d?","+v(d,t):",[]",o+="tR+="+m(g+=",c)",u)+";"}else"s"===i?o+="tR+="+m((p?"await ":"")+"c.l('H','"+s+"')({params:["+l+"]},[],c)",u)+";":"e"===i&&(o+=c+"\n")}}return o}var w=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){c(this.cache,e,!0)},e}();function O(e,t,n,o){if(t&&t.length>0)throw r((o?"Native":"")+"Helper '"+e+"' doesn't accept blocks");if(n&&n.length>0)throw r((o?"Native":"")+"Helper '"+e+"' doesn't accept filters")}var x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function S(e){return x[e]}var A=new w({}),N=new w({each:function(e,t){var r="",n=e.params[0];if(O("each",t,!1),e.async)return new Promise((function(t){!function e(t,r,n,o,a){n(t[r],r).then((function(i){o+=i,r===t.length-1?a(o):e(t,r+1,n,o,a)}))}(n,0,e.exec,r,t)}));for(var o=0;o<n.length;o++)r+=e.exec(n[o],o);return r},foreach:function(e,t){var r=e.params[0];if(O("foreach",t,!1),e.async)return new Promise((function(t){!function e(t,r,n,o,a,i){o(r[n],t[r[n]]).then((function(c){a+=c,n===r.length-1?i(a):e(t,r,n+1,o,a,i)}))}(r,Object.keys(r),0,e.exec,"",t)}));var n="";for(var o in r)i(r,o)&&(n+=e.exec(o,r[o]));return n},include:function(e,t,n){O("include",t,!1);var o=n.storage.templates.get(e.params[0]);if(!o)throw r('Could not fetch template "'+e.params[0]+'"');return o(e.params[1],n)},extends:function(e,t,n){var o=e.params[1]||{};o.content=e.exec();for(var a=0;a<t.length;a++){var i=t[a];o[i.name]=i.exec()}var c=n.storage.templates.get(e.params[0]);if(!c)throw r('Could not fetch template "'+e.params[0]+'"');return c(o,n)},useScope:function(e,t){return O("useScope",t,!1),e.exec(e.params[0])}}),j=new w({if:function(e,t){O("if",!1,e.f,!0);var r="if("+e.p+"){"+_(e.d,t)+"}";if(e.b)for(var n=0;n<e.b.length;n++){var o=e.b[n];"else"===o.n?r+="else{"+_(o.d,t)+"}":"elif"===o.n&&(r+="else if("+o.p+"){"+_(o.d,t)+"}")}return r},try:function(e,t){if(O("try",!1,e.f,!0),!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw r("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+_(e.d,t)+"}",o=e.b[0];return n+"catch"+(o.res?"("+o.res+")":"")+"{"+_(o.d,t)+"}"},block:function(e,t){return O("block",e.b,e.f,!0),"if(!"+t.varName+"["+e.p+"]){tR+=("+b(e.d,"",t)+")()}else{tR+="+t.varName+"["+e.p+"]}"}}),E=new w({e:function(e){var t=String(e);return/[&<>"']/.test(t)?t.replace(/[&<>"']/g,S):t}}),T={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,t){if("H"===e){var n=this.storage.helpers.get(t);if(n)return n;throw r("Can't find helper '"+t+"'")}if("F"===e){var o=this.storage.filters.get(t);if(o)return o;throw r("Can't find filter '"+t+"'")}},async:!1,storage:{helpers:N,nativeHelpers:j,filters:E,templates:A},prefixes:{h:"@",b:"#",i:"",r:"*",c:"/",e:"!"},cache:!1,plugins:[],useWith:!1};function C(e,t){var r={};return c(r,T),t&&c(r,t),e&&c(r,e),r.l.bind(r),r}function I(e,t){var n=C(t||{}),o=Function;if(n.async){if(!a)throw r("This environment doesn't support async/await");o=a}try{return new o(n.varName,"c","cb",g(e,n))}catch(t){throw t instanceof SyntaxError?r("Bad template syntax\n\n"+t.message+"\n"+Array(t.message.length+1).join("=")+"\n"+g(e,n)):t}}function U(e,t){var r;return t.cache&&t.name&&t.storage.templates.get(t.name)?t.storage.templates.get(t.name):(r="function"==typeof e?e:I(e,t),t.cache&&t.name&&t.storage.templates.define(t.name,r),r)}T.l.bind(T),e.compile=I,e.compileScope=_,e.compileScopeIntoFunction=b,e.compileToString=g,e.defaultConfig=T,e.filters=E,e.getConfig=C,e.helpers=N,e.nativeHelpers=j,e.parse=h,e.render=function(e,t,n,a){var i=C(n||{});if(!i.async)return U(e,i)(t,i);if(!a){if("function"==typeof o)return new o((function(r,n){try{r(U(e,i)(t,i))}catch(e){n(e)}}));throw r("Please provide a callback function, this env doesn't support Promises")}try{U(e,i)(t,i,a)}catch(e){return a(e)}},e.templates=A,Object.defineProperty(e,"__esModule",{value:!0})})(H.exports);var $=n(H.exports),D=Object.freeze(e({__proto__:null,default:$},[H.exports])),V={};function q(e,t,r,n){var o,a=!1,i=0;function c(){o&&clearTimeout(o)}function u(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=this,d=Date.now()-i;function p(){i=Date.now(),r.apply(f,s)}function h(){o=void 0}a||(n&&!o&&p(),c(),void 0===n&&d>e?p():!0!==t&&(o=setTimeout(n?h:p,void 0===n?e-d:e)))}return"boolean"!=typeof t&&(n=r,r=t,t=void 0),u.cancel=function(){c(),a=!0},u}Object.defineProperty(V,"__esModule",{value:!0}),V.debounce=function(e,t,r){return void 0===r?q(e,t,!1):q(e,r,!1!==t)};var z=V.throttle=q;return function(){function e(t){var n=this;this._initialConfig={$element:document.body,deepmerge:{isMergeableObject:j},delegations:{},filters:{},helpers:{},initialState:{},load:function(){},morphdom:{},nativeHelpers:{},nonBubblingEvents:e.NON_BUBBLING_EVENTS,partials:{},shouldUpdate:function(e,t){return!A(e,t)},squirrelly:H.exports.defaultConfig,template:"",unload:function(){},update:function(){}},this._enforcedConfig={deepmerge:{clone:!1},morphdom:{childrenOnly:!1},squirrelly:{varName:"state"}},this._delegationFuncs={},this._loaded=!1,this._state={},this._throttledLoadOrUpdate=L(this._loadOrUpdate),this._throttledRender=L(this._render),this._config=S.all([this._initialConfig,g(t),this._enforcedConfig],r(r({},this._initialConfig.deepmerge),this._enforcedConfig.deepmerge)),j(this._config.initialState)&&null!==this._config.initialState?(["filters","helpers","nativeHelpers"].forEach((function(e){Object.keys(n._config[e]).forEach((function(t){D[e].define(t,n._config[e][t])}))})),Object.keys(this._config.partials).forEach((function(e){H.exports.templates.define(e,H.exports.compile(n._getTemplate(n._config.partials[e]),r(r({},n._config.squirrelly),{varName:"partialState"})))})),this._compiledTemplate=H.exports.compile(this._getTemplate(this._config.template),this._config.squirrelly),Object.keys(this._config.delegations).forEach((function(e,t){e.trim().split(/\s*,\s*/g).forEach((function(r){var o="".concat(r,":").concat(t);if(o in n._delegationFuncs)console.warn('RIsland: event name "'.concat(r,'" exists more than once in "').concat(e,'". This occurence will simply be ignored.'));else{var a=n._getThrottling(r);n._delegationFuncs[o]={capture:-1!==n._config.nonBubblingEvents.indexOf(a.eventName),func:function(t){t.target instanceof Element&&Object.keys(n._config.delegations[e]).forEach((function(r){var o=t.target.closest(r);null!==o&&n._config.delegations[e][r](t,o,g(n._state),n._setState.bind(n))}))}},!0===a.throttled&&(n._delegationFuncs[o].func="ms"in a?z(a.ms,n._delegationFuncs[o].func):L(n._delegationFuncs[o].func)),n._config.$element.addEventListener(a.eventName,n._delegationFuncs[o].func,{capture:n._delegationFuncs[o].capture})}}))})),0===Object.keys(this._config.initialState).length?(console.warn("RIsland: Initialisation with an empty state is considered an anti-pattern. Please try to predefine everything you will later change with setState() with an initial value; even it is null."),this._throttledRender()):this._setState(this._config.initialState)):console.error("RIsland: initialState has to be an object (which is not null).")}return e.prototype.unload=function(){var e=this;Object.keys(this._delegationFuncs).forEach((function(t){e._config.$element.removeEventListener(t.split(/:/g)[0],e._delegationFuncs[t].func,{capture:e._delegationFuncs[t].capture})})),this._config.$element.innerHTML="",this._config.unload(g(this._state))},e.prototype._setState=function(e){var t=this,r="function"==typeof e?e(g(this._state)):e;if(null!==r)if(r instanceof Promise)r.then((function(e){return t._setState(e)}));else if(Array.isArray(r))r.forEach((function(e){return t._setState(e)}));else{var n="customMerge"in this._config.deepmerge?S(g(this._state),r,this._config.deepmerge):S(this._state,r,this._config.deepmerge),o=this._config.shouldUpdate===this._initialConfig.shouldUpdate?this._config.shouldUpdate(this._state,n):this._config.shouldUpdate(g(this._state),"customMerge"in this._config.deepmerge?n:g(n));this._state=n,!0===o&&this._throttledRender()}},e.prototype._render=function(){var e=this;!1!==this._loaded&&null!==this._config.$element.firstChild||(this._config.$element.innerHTML="<div></div>"),B(this._config.$element.firstChild,this._compiledTemplate(this._state,this._config.squirrelly),r(r({},this._config.morphdom),{onBeforeElUpdated:function(t,r){return(!("onBeforeElUpdated"in e._config.morphdom)||!1!==e._config.morphdom.onBeforeElUpdated(t,r))&&!t.isEqualNode(r)},onElUpdated:function(t){e._throttledLoadOrUpdate(),"onElUpdated"in e._config.morphdom&&e._config.morphdom.onElUpdated(t)},onNodeAdded:function(t){return e._throttledLoadOrUpdate(),"onNodeAdded"in e._config.morphdom?e._config.morphdom.onNodeAdded(t):t},onNodeDiscarded:function(t){return e._throttledLoadOrUpdate(),"onNodeDiscarded"in e._config.morphdom?e._config.morphdom.onNodeDiscarded(t):t}}))},e.prototype._getTemplate=function(e){if("string"==typeof e)return e;if(e instanceof HTMLScriptElement)return e.innerHTML;var t="RIsland: template must be a string or a script tag element.";return console.error(t),'<p style="color:red;">'.concat(t,"</p>")},e.prototype._getThrottling=function(e){var t=e.split(/\./g),r=t[0];if(t.length>1&&"throttled"===t[1]){if(3===t.length){var n=parseInt(t[2],10);if(!isNaN(n))return{eventName:r,ms:n,throttled:!0};console.warn('RIsland: event name "'.concat(e,'" is malformed. The milliseconds "').concat(t[2],'" are not a valid number. falling back to request animation frame.'))}return{eventName:r,throttled:!0}}return{eventName:r,throttled:!1}},e.prototype._loadOrUpdate=function(){var e=g(this._state);!1===this._loaded?(this._loaded=!0,this._config.load(e,this._setState.bind(this))):this._config.update(e,this._setState.bind(this))},e.NON_BUBBLING_EVENTS=["abort","blur","error","focus","load","loadend","loadstart","pointerenter","pointerleave","progress","scroll","unload"],e}()}();
