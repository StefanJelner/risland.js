/**
 * @license
 * author: Stefan Jelner
 * risland.js v0.0.11
 * Released under the ISC license.
 * 
 * See https://github.com/StefanJelner/risland.js.git
 */
var RIsland=function(){"use strict";function e(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */}var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};
/**
   * @license
   * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
   * This code may only be used under the BSD style license found at
   * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
   * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
   * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
   * Google as part of the polymer project is also subject to an additional IP
   * rights grant found at http://polymer.github.io/PATENTS.txt
   */
!function(){if(void 0!==window.Reflect&&void 0!==window.customElements&&!window.customElements.polyfillWrapFlushCallback){var e=HTMLElement;window.HTMLElement=function(){return Reflect.construct(e,[],this.constructor)},HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}}();var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var a={},c={};Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(e){var t;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return cancelAnimationFrame(t),new Promise((function(n){t=requestAnimationFrame((function(){var t=e.apply(void 0,r);n(t)}))}))}};var s=i&&i.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0});var l=s(c),u=a.default=l.default,f=function(e){return function(e){return!!e&&"object"===t(e)}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===d}(e)}(e)},d="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function p(e,t){return!1!==t.clone&&t.isMergeableObject(e)?v((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function h(e,t,n){return e.concat(t).map((function(e){return p(e,n)}))}function g(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function m(e,t){try{return t in e}catch(e){return!1}}function v(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||h,n.isMergeableObject=n.isMergeableObject||f,n.cloneUnlessOtherwiseSpecified=p;var r=Array.isArray(t);return r===Array.isArray(e)?r?n.arrayMerge(e,t,n):function(e,t,n){var r={};return n.isMergeableObject(e)&&g(e).forEach((function(t){r[t]=p(e[t],n)})),g(t).forEach((function(i){(function(e,t){return m(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(m(e,i)&&n.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return v;var n=t.customMerge(e);return"function"==typeof n?n:v}(i,n)(e[i],t[i],n):r[i]=p(t[i],n))})),r}(e,t,n):p(t,n)}v.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return v(e,n,t)}),{})};var y,_=v,b=function e(n,r){if(n===r)return!0;if(n&&r&&"object"==t(n)&&"object"==t(r)){if(n.constructor!==r.constructor)return!1;var i,o,a;if(Array.isArray(n)){if((i=n.length)!=r.length)return!1;for(o=i;0!=o--;)if(!e(n[o],r[o]))return!1;return!0}if(n.constructor===RegExp)return n.source===r.source&&n.flags===r.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===r.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===r.toString();if((i=(a=Object.keys(n)).length)!==Object.keys(r).length)return!1;for(o=i;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,a[o]))return!1;for(o=i;0!=o--;){var c=a[o];if(!e(n[c],r[c]))return!1}return!0}return n!=n&&r!=r};
/*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   */
function w(e){return"[object Object]"===Object.prototype.toString.call(e)}function O(e){var t,n;return!1!==w(e)&&(void 0===(t=e.constructor)||!1!==w(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf"))}function S(e){if("object"!=typeof e)return e;var t,n,r=Object.prototype.toString.call(e);if("[object Object]"===r){if(e.constructor!==Object&&"function"==typeof e.constructor)for(t in n=new e.constructor,e)e.hasOwnProperty(t)&&n[t]!==e[t]&&(n[t]=S(e[t]));else for(t in n={},e)"__proto__"===t?Object.defineProperty(n,t,{value:S(e[t]),configurable:!0,enumerable:!0,writable:!0}):n[t]=S(e[t]);return n}if("[object Array]"===r){for(t=e.length,n=Array(t);t--;)n[t]=S(e[t]);return n}return"[object Set]"===r?(n=new Set,e.forEach((function(e){n.add(S(e))})),n):"[object Map]"===r?(n=new Map,e.forEach((function(e,t){n.set(S(t),S(e))})),n):"[object Date]"===r?new Date(+e):"[object RegExp]"===r?((n=new RegExp(e.source,e.flags)).lastIndex=e.lastIndex,n):"[object DataView]"===r?new e.constructor(S(e.buffer)):"[object ArrayBuffer]"===r?e.slice(0):"Array]"===r.slice(-6)?new e.constructor(e):e}var x="undefined"==typeof document?void 0:document,E=!!x&&"content"in x.createElement("template"),N=!!x&&x.createRange&&"createContextualFragment"in x.createRange();function j(e,t){var n,r,i=e.nodeName,o=t.nodeName;return i===o||(n=i.charCodeAt(0),r=o.charCodeAt(0),n<=90&&r>=97?i===o.toUpperCase():r<=90&&n>=97&&o===i.toUpperCase())}function A(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var T={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}A(e,t,"selected")},INPUT:function(e,t){A(e,t,"checked"),A(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var i=r.nodeValue;if(i==n||!n&&i==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,i=-1,o=0,a=e.firstChild;a;)if("OPTGROUP"===(r=a.nodeName&&a.nodeName.toUpperCase()))a=(n=a).firstChild;else{if("OPTION"===r){if(a.hasAttribute("selected")){i=o;break}o++}!(a=a.nextSibling)&&n&&(a=n.nextSibling,n=null)}e.selectedIndex=i}}};function C(){}function R(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var M=function(e,t,n){if(n||(n={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var r=t;(t=x.createElement("html")).innerHTML=r}else i=(i=t).trim(),t=E?function(e){var t=x.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(i):N?function(e){return y||(y=x.createRange()).selectNode(x.body),y.createContextualFragment(e).childNodes[0]}(i):function(e){var t=x.createElement("body");return t.innerHTML=e,t.childNodes[0]}(i);var i,o=n.getNodeKey||R,a=n.onBeforeNodeAdded||C,c=n.onNodeAdded||C,s=n.onBeforeElUpdated||C,l=n.onElUpdated||C,u=n.onBeforeNodeDiscarded||C,f=n.onNodeDiscarded||C,d=n.onBeforeElChildrenUpdated||C,p=!0===n.childrenOnly,h=Object.create(null),g=[];function m(e){g.push(e)}function v(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=o(n))?m(r):(f(n),n.firstChild&&v(n,t)),n=n.nextSibling}}function _(e,t,n){!1!==u(e)&&(t&&t.removeChild(e),f(e),v(e,n))}function b(e){c(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=o(t);if(r){var i=h[r];i&&j(t,i)?(t.parentNode.replaceChild(i,t),w(i,t)):b(t)}else b(t);t=n}}function w(e,t,n){var r=o(t);if(r&&delete h[r],!n){if(!1===s(e,t))return;if(function(e,t){var n,r,i,o,a=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var c=a.length-1;c>=0;c--)r=(n=a[c]).name,i=n.namespaceURI,o=n.value,i?(r=n.localName||r,e.getAttributeNS(i,r)!==o&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(i,r,o))):e.getAttribute(r)!==o&&e.setAttribute(r,o);for(var s=e.attributes,l=s.length-1;l>=0;l--)r=(n=s[l]).name,(i=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(i,r)||e.removeAttributeNS(i,r)):t.hasAttribute(r)||e.removeAttribute(r)}}(e,t),l(e),!1===d(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,r,i,c,s,l=t.firstChild,u=e.firstChild;e:for(;l;){for(c=l.nextSibling,n=o(l);u;){if(i=u.nextSibling,l.isSameNode&&l.isSameNode(u)){l=c,u=i;continue e}r=o(u);var f=u.nodeType,d=void 0;if(f===l.nodeType&&(1===f?(n?n!==r&&((s=h[n])?i===s?d=!1:(e.insertBefore(s,u),r?m(r):_(u,e,!0),u=s):d=!1):r&&(d=!1),(d=!1!==d&&j(u,l))&&w(u,l)):3!==f&&8!=f||(d=!0,u.nodeValue!==l.nodeValue&&(u.nodeValue=l.nodeValue))),d){l=c,u=i;continue e}r?m(r):_(u,e,!0),u=i}if(n&&(s=h[n])&&j(s,l))e.appendChild(s),w(s,l);else{var p=a(l);!1!==p&&(p&&(l=p),l.actualize&&(l=l.actualize(e.ownerDocument||x)),e.appendChild(l),b(l))}l=c,u=i}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=o(t))?m(n):_(t,e,!0),t=r}}(e,u,r);var g=T[e.nodeName];g&&g(e,t)}(e,t):T.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=o(n);r&&(h[r]=n),e(n),n=n.nextSibling}}(e);var O,S,A=e,M=A.nodeType,F=t.nodeType;if(!p)if(1===M)1===F?j(e,t)||(f(e),A=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(e,(O=t.nodeName,(S=t.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==S?x.createElementNS(S,O):x.createElement(O)))):A=t;else if(3===M||8===M){if(F===M)return A.nodeValue!==t.nodeValue&&(A.nodeValue=t.nodeValue),A;A=t}if(A===t)f(e);else{if(t.isSameNode&&t.isSameNode(A))return;if(w(A,t,p),g)for(var P=0,U=g.length;P<U;P++){var I=h[g[P]];I&&_(I,I.parentNode,!1)}}return!p&&A!==e&&e.parentNode&&(A.actualize&&(A=A.actualize(e.ownerDocument||x)),e.parentNode.replaceChild(A,e)),A},F=function(e){var t,n=null,r=function(r){return function(){n=null,e.apply(r,t)}},i=function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];t=i,null===n&&(n=requestAnimationFrame(r(this)))};return i.cancel=function(){cancelAnimationFrame(n),n=null},i},P={exports:{}};!function(e){function n(e){var t,r,i=new Error(e);return t=i,r=n.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r,i}function r(e,t,r){var i=t.slice(0,r).split(/\n/),o=i.length,a=i[o-1].length+1;throw n(e+=" at line "+o+" col "+a+":\n\n  "+t.split(/\n/)[o-1]+"\n  "+Array(a).join(" ")+"^")}n.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var i=new Function("return this")().Promise,o=!1;try{o=new Function("return (async function(){}).constructor")()}catch(e){if(!(e instanceof SyntaxError))throw e}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,n,r){for(var i in n)a(n,i)&&(null==n[i]||"object"!=t(n[i])||"storage"!==i&&"prefixes"!==i||r?e[i]=n[i]:e[i]=c({},n[i]));return e}var s=/^async +/,l=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,u=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,f=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g,d=/[.*+\-?^${}()|[\]\\]/g;function p(e){return d.test(e)?e.replace(d,"\\$&"):e}function h(e,t){t.rmWhitespace&&(e=e.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),l.lastIndex=0,u.lastIndex=0,f.lastIndex=0;var i=t.prefixes,o=[i.h,i.b,i.i,i.r,i.c,i.e].reduce((function(e,t){return e&&t?e+"|"+p(t):t?p(t):e}),""),a=new RegExp("([|()]|=>)|('|\"|`|\\/\\*)|\\s*((\\/)?(-|_)?"+p(t.tags[1])+")","g"),c=new RegExp("([^]*?)"+p(t.tags[0])+"(-|_)?\\s*("+o+")?\\s*","g"),d=0,h=!1;function g(n,i){var o,p={f:[]},g=0,m="c";function v(n){var i=e.slice(d,n),o=i.trim();if("f"===m)"safe"===o?p.raw=!0:t.async&&s.test(o)?(o=o.replace(s,""),p.f.push([o,"",!0])):p.f.push([o,""]);else if("fp"===m)p.f[p.f.length-1][1]+=o;else if("err"===m){if(o){var a=i.search(/\S/);r("invalid syntax",e,d+a)}}else p[m]=o;d=n+1}for("h"===i||"b"===i||"c"===i?m="n":"r"===i&&(p.raw=!0,i="i"),a.lastIndex=d;null!==(o=a.exec(e));){var y=o[1],_=o[2],b=o[3],w=o[4],O=o[5],S=o.index;if(y)"("===y?(0===g&&("n"===m?(v(S),m="p"):"f"===m&&(v(S),m="fp")),g++):")"===y?0==--g&&"c"!==m&&(v(S),m="err"):0===g&&"|"===y?(v(S),m="f"):"=>"===y&&(v(S),d+=1,m="res");else if(_)if("/*"===_){var x=e.indexOf("*/",a.lastIndex);-1===x&&r("unclosed comment",e,o.index),a.lastIndex=x+2}else"'"===_?(u.lastIndex=o.index,u.exec(e)?a.lastIndex=u.lastIndex:r("unclosed string",e,o.index)):'"'===_?(f.lastIndex=o.index,f.exec(e)?a.lastIndex=f.lastIndex:r("unclosed string",e,o.index)):"`"===_&&(l.lastIndex=o.index,l.exec(e)?a.lastIndex=l.lastIndex:r("unclosed string",e,o.index));else if(b)return v(S),d=S+o[0].length,c.lastIndex=d,h=O,w&&"h"===i&&(i="s"),p.t=i,p}return r("unclosed tag",e,n),p}var m=function o(a,l){a.b=[],a.d=[];var u,f=!1,p=[];function m(e,n){e&&(e=function(e,t,n,r){var i,o;return"string"==typeof t.autoTrim?i=o=t.autoTrim:Array.isArray(t.autoTrim)&&(i=t.autoTrim[1],o=t.autoTrim[0]),(n||!1===n)&&(i=n),(r||!1===r)&&(o=r),"slurp"===i&&"slurp"===o?e.trim():("_"===i||"slurp"===i?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==i&&"nl"!==i||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===o||"slurp"===o?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==o&&"nl"!==o||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(e,t,h,n))&&(e=e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),p.push(e))}for(;null!==(u=c.exec(e));){var v,y=u[1],_=u[2],b=u[3]||"";for(var w in i)if(i[w]===b){v=w;break}m(y,_),d=u.index+u[0].length,v||r("unrecognized tag type: "+b,e,d);var O=g(u.index,v),S=O.t;if("h"===S){var x=O.n||"";t.async&&s.test(x)&&(O.a=!0,O.n=x.replace(s,"")),O=o(O),p.push(O)}else if("c"===S){if(a.n===O.n)return f?(f.d=p,a.b.push(f)):a.d=p,a;r("Helper start and end don't match",e,u.index+u[0].length)}else if("b"===S){f?(f.d=p,a.b.push(f)):a.d=p;var E=O.n||"";t.async&&s.test(E)&&(O.a=!0,O.n=E.replace(s,"")),f=O,p=[]}else if("s"===S){var N=O.n||"";t.async&&s.test(N)&&(O.a=!0,O.n=N.replace(s,"")),p.push(O)}else p.push(O)}if(!l)throw n('unclosed helper "'+a.n+'"');return m(e.slice(d,e.length),!1),a.d=p,a}({f:[]},!0);if(t.plugins)for(var v=0;v<t.plugins.length;v++){var y=t.plugins[v];y.processAST&&(m.d=y.processAST(m.d,t))}return m.d}function g(e,t){var n=h(e,t),r="var tR='';"+(t.useWith?"with("+t.varName+"||{}){":"")+b(n,t)+"if(cb){cb(null,tR)} return tR"+(t.useWith?"}":"");if(t.plugins)for(var i=0;i<t.plugins.length;i++){var o=t.plugins[i];o.processFnString&&(r=o.processFnString(r,t))}return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n][0],i=t[n][1];e=(t[n][2]?"await ":"")+"c.l('F','"+r+"')("+e,i&&(e+=","+i),e+=")"}return e}function v(e,t,n,r,i,o){var a="{exec:"+(i?"async ":"")+_(n,t,e)+",params:["+r+"]";return o&&(a+=",name:'"+o+"'"),i&&(a+=",async:true"),a+"}"}function y(e,t){for(var n="[",r=0;r<e.length;r++){var i=e[r];n+=v(t,i.res||"",i.d,i.p||"",i.a,i.n),r<e.length&&(n+=",")}return n+"]"}function _(e,t,n){return"function("+t+"){var tR='';"+b(e,n)+"return tR}"}function b(e,t){for(var n=0,r=e.length,i="";n<r;n++){var o=e[n];if("string"==typeof o)i+="tR+='"+o+"';";else{var a=o.t,c=o.c||"",s=o.f,l=o.n||"",u=o.p||"",f=o.res||"",d=o.b,p=!!o.a;if("i"===a){t.defaultFilter&&(c="c.l('F','"+t.defaultFilter+"')("+c+")");var h=m(c,s);!o.raw&&t.autoEscape&&(h="c.l('F','e')("+h+")"),i+="tR+="+h+";"}else if("h"===a)if(t.storage.nativeHelpers.get(l))i+=t.storage.nativeHelpers.get(l)(o,t);else{var g=(p?"await ":"")+"c.l('H','"+l+"')("+v(t,f,o.d,u,p);g+=d?","+y(d,t):",[]",i+="tR+="+m(g+=",c)",s)+";"}else"s"===a?i+="tR+="+m((p?"await ":"")+"c.l('H','"+l+"')({params:["+u+"]},[],c)",s)+";":"e"===a&&(i+=c+"\n")}}return i}var w=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){c(this.cache,e,!0)},e}();function O(e,t,r,i){if(t&&t.length>0)throw n((i?"Native":"")+"Helper '"+e+"' doesn't accept blocks");if(r&&r.length>0)throw n((i?"Native":"")+"Helper '"+e+"' doesn't accept filters")}var S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function x(e){return S[e]}var E=new w({}),N=new w({each:function(e,t){var n="",r=e.params[0];if(O("each",t,!1),e.async)return new Promise((function(t){!function e(t,n,r,i,o){r(t[n],n).then((function(a){i+=a,n===t.length-1?o(i):e(t,n+1,r,i,o)}))}(r,0,e.exec,n,t)}));for(var i=0;i<r.length;i++)n+=e.exec(r[i],i);return n},foreach:function(e,t){var n=e.params[0];if(O("foreach",t,!1),e.async)return new Promise((function(t){!function e(t,n,r,i,o,a){i(n[r],t[n[r]]).then((function(c){o+=c,r===n.length-1?a(o):e(t,n,r+1,i,o,a)}))}(n,Object.keys(n),0,e.exec,"",t)}));var r="";for(var i in n)a(n,i)&&(r+=e.exec(i,n[i]));return r},include:function(e,t,r){O("include",t,!1);var i=r.storage.templates.get(e.params[0]);if(!i)throw n('Could not fetch template "'+e.params[0]+'"');return i(e.params[1],r)},extends:function(e,t,r){var i=e.params[1]||{};i.content=e.exec();for(var o=0;o<t.length;o++){var a=t[o];i[a.name]=a.exec()}var c=r.storage.templates.get(e.params[0]);if(!c)throw n('Could not fetch template "'+e.params[0]+'"');return c(i,r)},useScope:function(e,t){return O("useScope",t,!1),e.exec(e.params[0])}}),j=new w({if:function(e,t){O("if",!1,e.f,!0);var n="if("+e.p+"){"+b(e.d,t)+"}";if(e.b)for(var r=0;r<e.b.length;r++){var i=e.b[r];"else"===i.n?n+="else{"+b(i.d,t)+"}":"elif"===i.n&&(n+="else if("+i.p+"){"+b(i.d,t)+"}")}return n},try:function(e,t){if(O("try",!1,e.f,!0),!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw n("native helper 'try' only accepts 1 block, 'catch'");var r="try{"+b(e.d,t)+"}",i=e.b[0];return r+"catch"+(i.res?"("+i.res+")":"")+"{"+b(i.d,t)+"}"},block:function(e,t){return O("block",e.b,e.f,!0),"if(!"+t.varName+"["+e.p+"]){tR+=("+_(e.d,"",t)+")()}else{tR+="+t.varName+"["+e.p+"]}"}}),A=new w({e:function(e){var t=String(e);return/[&<>"']/.test(t)?t.replace(/[&<>"']/g,x):t}}),T={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,t){if("H"===e){var r=this.storage.helpers.get(t);if(r)return r;throw n("Can't find helper '"+t+"'")}if("F"===e){var i=this.storage.filters.get(t);if(i)return i;throw n("Can't find filter '"+t+"'")}},async:!1,storage:{helpers:N,nativeHelpers:j,filters:A,templates:E},prefixes:{h:"@",b:"#",i:"",r:"*",c:"/",e:"!"},cache:!1,plugins:[],useWith:!1};function C(e,t){var n={};return c(n,T),t&&c(n,t),e&&c(n,e),n.l.bind(n),n}function R(e,t){var r=C(t||{}),i=Function;if(r.async){if(!o)throw n("This environment doesn't support async/await");i=o}try{return new i(r.varName,"c","cb",g(e,r))}catch(t){throw t instanceof SyntaxError?n("Bad template syntax\n\n"+t.message+"\n"+Array(t.message.length+1).join("=")+"\n"+g(e,r)):t}}function M(e,t){var n;return t.cache&&t.name&&t.storage.templates.get(t.name)?t.storage.templates.get(t.name):(n="function"==typeof e?e:R(e,t),t.cache&&t.name&&t.storage.templates.define(t.name,n),n)}T.l.bind(T),e.compile=R,e.compileScope=b,e.compileScopeIntoFunction=_,e.compileToString=g,e.defaultConfig=T,e.filters=A,e.getConfig=C,e.helpers=N,e.nativeHelpers=j,e.parse=h,e.render=function(e,t,r,o){var a=C(r||{});if(!a.async)return M(e,a)(t,a);if(!o){if("function"==typeof i)return new i((function(n,r){try{n(M(e,a)(t,a))}catch(e){r(e)}}));throw n("Please provide a callback function, this env doesn't support Promises")}try{M(e,a)(t,a,o)}catch(e){return o(e)}},e.templates=E,Object.defineProperty(e,"__esModule",{value:!0})}(P.exports);var U=o(P.exports),I=Object.freeze(e({__proto__:null,default:U},[P.exports])),L={};function H(e,t,n,r){var i,o=!1,a=0;function c(){i&&clearTimeout(i)}function s(){for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];var f=this,d=Date.now()-a;function p(){a=Date.now(),n.apply(f,l)}function h(){i=void 0}o||(r&&!i&&p(),c(),void 0===r&&d>e?p():!0!==t&&(i=setTimeout(r?h:p,void 0===r?e-d:e)))}return"boolean"!=typeof t&&(r=n,n=t,t=void 0),s.cancel=function(){c(),o=!0},s}Object.defineProperty(L,"__esModule",{value:!0});var k=L.debounce=function(e,t,n){return void 0===n?H(e,t,!1):H(e,n,!1!==t)},$=L.throttle=H;return function(){function e(t){var n=this;this._empty="<div></div>",this._initialConfig={$element:document.body,deepmerge:{isMergeableObject:O},delegations:{},error:function(){},filters:{},helpers:{},initialState:{},load:function(){},morphdom:{},nativeHelpers:{},nonBubblingEvents:e.NON_BUBBLING_EVENTS,partials:{},shouldUpdate:function(e,t,n){return!n(e,t)},squirrelly:P.exports.defaultConfig,template:this._empty,unload:function(){},update:function(){}},this._enforcedConfig={deepmerge:{clone:!1},morphdom:{childrenOnly:!1},squirrelly:{varName:"state"}},this._internalSqrlConfig=r(r({},P.exports.defaultConfig),this._enforcedConfig.squirrelly),this._compiledConsole=P.exports.compile("{{state.type}}:\n\n{{@each(state.messages) => message}}- {{message}}\n{{/each}}",this._internalSqrlConfig),this._compiledError=P.exports.compile('<ul style="color:red;">{{@each(state.errors) => error}}<li>{{error}}</li>{{/each}}</ul>',this._internalSqrlConfig),this._delegationFuncs={},this._errors=[],this._loaded=!1,this._state={},this._throttledLoadOrUpdate=F(this._loadOrUpdate),this._throttledRender=F(this._render),this._warnings=[],this._config=_.all([this._initialConfig,S(t),this._enforcedConfig],r(r({},this._initialConfig.deepmerge),this._enforcedConfig.deepmerge)),O(this._config.initialState)&&null!==this._config.initialState||(this._errors=this._errors.concat("ERR001: initialState has to be an object (which is not null)."),this._config.initialState=this._initialConfig.initialState),["filters","helpers","nativeHelpers"].forEach((function(e){Object.keys(n._config[e]).forEach((function(t){I[e].define(t,n._config[e][t])}))})),Object.keys(this._config.partials).forEach((function(e){P.exports.templates.define(e,P.exports.compile(n._getTemplate(n._config.partials[e]),r(r({},n._config.squirrelly),{varName:"partialState"})))})),this._compiledTemplate=P.exports.compile(this._getTemplate(this._config.template),this._config.squirrelly),Object.keys(this._config.delegations).forEach((function(e,t){e.trim().split(/\s*,\s*/g).forEach((function(r){var i="".concat(r,":").concat(t);if(i in n._delegationFuncs)n._warnings=n._warnings.concat('WARN001: RIsland: event name "'.concat(r,'" exists more than once in "').concat(e,'". This occurence will simply be ignored.'));else{var o=n._getThrottling(r);n._delegationFuncs[i]={capture:-1!==n._config.nonBubblingEvents.indexOf(o.eventName),func:function(t){t.target instanceof Element&&Object.keys(n._config.delegations[e]).forEach((function(r){var i=t.target.closest(r);null!==i&&n._config.delegations[e][r](t,i,S(n._state),n._setState.bind(n))}))}},!0===o.throttled&&(n._delegationFuncs[i].func="ms"in o?$(o.ms,n._delegationFuncs[i].func):F(n._delegationFuncs[i].func)),!0===o.debounced&&(n._delegationFuncs[i].func="ms"in o?k(o.ms,n._delegationFuncs[i].func):u(n._delegationFuncs[i].func)),n._config.$element.addEventListener(o.eventName,n._delegationFuncs[i].func,{capture:n._delegationFuncs[i].capture})}}))})),0===Object.keys(this._config.initialState).length?(this._warnings=this._warnings.concat("WARN002: Initialisation with an empty state is considered an anti-pattern. Please try to predefine everything you will later change with setState() with an initial value; even it is null."),this._throttledRender()):this._setState(this._config.initialState)}return e.createWebComponent=function(t,i,o){window.customElements.define(t,function(t){function a(){var e=t.call(this)||this,n=e.attachShadow({mode:"open"});return e._$island=document.createElement("div"),n.appendChild(e._$island),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(a,t),Object.defineProperty(a,"observedAttributes",{get:function(){return i},enumerable:!1,configurable:!0}),a.prototype.connectedCallback=function(){var t=this;this._island=new e(r(r({},o),{$element:this._$island,initialState:_(o.initialState,i.reduce((function(e,n){var i,o=t.getAttribute(n);return null!==o&&""!==o?r(r({},e),((i={})[n]=t._parse(o),i)):e}),{}),{clone:!1,isMergeableObject:O}),load:function(e,n){t._setState=n,"load"in o&&o.load(e,n)}}))},a.prototype.disconnectedCallback=function(){this._island.unload()},a.prototype.attributeChangedCallback=function(e,t,n){var r;"_setState"in this&&"function"==typeof this._setState&&this._setState(((r={})[e]=this._parse(n),r))},a.prototype._parse=function(e){var t=e;if(/^[-+]?\d+(e[-+]?\d+)?$/i.test(t))return parseInt(t,10);if(/^[-+]?\d*\.\d+(e[-+]?\d+)?$/i.test(t))return parseFloat(t);try{t=JSON.parse(e)}catch(e){}return t},a}(HTMLElement))},e.prototype.unload=function(){var e=this;Object.keys(this._delegationFuncs).forEach((function(t){e._config.$element.removeEventListener(t.split(/:/g)[0],e._delegationFuncs[t].func,{capture:e._delegationFuncs[t].capture})})),this._config.$element.innerHTML="",this._config.unload(S(this._state))},e.prototype._setState=function(e){var t=this,n="function"==typeof e?e(S(this._state)):e;if(null!==n)if(n instanceof Promise)n.then((function(e){return t._setState(e)}));else if(Array.isArray(n))n.forEach((function(e){return t._setState(e)}));else{var r="customMerge"in this._config.deepmerge?_(S(this._state),n,this._config.deepmerge):_(this._state,n,this._config.deepmerge),i=this._config.shouldUpdate===this._initialConfig.shouldUpdate?this._config.shouldUpdate(this._state,r,b):this._config.shouldUpdate(S(this._state),"customMerge"in this._config.deepmerge?r:S(r),b);this._state=r,!0===i&&this._throttledRender()}},e.prototype._render=function(){var e=this,t=this._checkTemplate(this._compiledTemplate(this._state,this._config.squirrelly).trim());if(this._warnings.length>0&&(console.warn(this._compiledConsole({messages:this._warnings,type:"Warnings"},this._internalSqrlConfig)),this._warnings=[]),this._errors.length>0)return this._config.$element.innerHTML=this._compiledError({errors:this._errors},this._internalSqrlConfig),console.error(this._compiledConsole({messages:this._errors,type:"Errors"},this._internalSqrlConfig)),this._errors=[],void this._config.error();!1!==this._loaded&&1===this._config.$element.children.length||(this._config.$element.innerHTML=this._empty),!1!==this._loaded||this._config.$element.innerHTML!==t?M(this._config.$element.firstChild,t,r(r({},this._config.morphdom),{onBeforeElUpdated:function(t,n){return!("onBeforeElUpdated"in e._config.morphdom&&!1===e._config.morphdom.onBeforeElUpdated(t,n)||t.isEqualNode(n))},onElUpdated:function(t){e._throttledLoadOrUpdate(),"onElUpdated"in e._config.morphdom&&e._config.morphdom.onElUpdated(t)},onNodeAdded:function(t){return e._throttledLoadOrUpdate(),"onNodeAdded"in e._config.morphdom?e._config.morphdom.onNodeAdded(t):t},onNodeDiscarded:function(t){return e._throttledLoadOrUpdate(),"onNodeDiscarded"in e._config.morphdom?e._config.morphdom.onNodeDiscarded(t):t}})):this._throttledLoadOrUpdate()},e.prototype._checkTemplate=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes.length>1?(this._errors=this._errors.concat("ERR002: the root level of your template MUST NOT contain more than one tag. Consider using a single div tag as a wrapper around your template."),this._empty):0===t.children.length?t.childNodes.length>0?(this._errors=this._errors.concat("ERR003: the root level of your template MUST NOT contain a single text node. Consider using a single div tag as a wrapper around your template."),this._empty):this._empty:e},e.prototype._getTemplate=function(e){return"string"==typeof e?e:e instanceof HTMLScriptElement?e.innerHTML:(this._errors=this._errors.concat("ERR004: template must be a string or a script tag element."),"")},e.prototype._getThrottling=function(e){var t,n,i=e.split(/\./g),o={debounced:!1,eventName:i[0],throttled:!1};if(i.length>1&&-1!==["throttled","debounced"].indexOf(i[1])){if(3===i.length){var a=parseInt(i[2],10);if(!isNaN(a))return r(r({},o),((t={ms:a})[i[1]]=!0,t));this._warnings=this._warnings.concat('WARN003: event name "'.concat(e,'" is malformed. The milliseconds "').concat(i[2],'" are not a valid number. falling back to request animation frame.'))}return r(r({},o),((n={})[i[1]]=!0,n))}return o},e.prototype._loadOrUpdate=function(){var e=S(this._state);!1===this._loaded?(this._loaded=!0,this._config.load(e,this._setState.bind(this))):this._config.update(e,this._setState.bind(this))},e.NON_BUBBLING_EVENTS=["abort","blur","error","focus","load","loadend","loadstart","pointerenter","pointerleave","progress","scroll","unload"],e}()}();
