/**
 * @license
 * author: Stefan Jelner
 * risland.js v0.0.1
 * Released under the ISC license.
 * 
 * See https://github.com/StefanJelner/risland.js.git
 */
var RIsland=function(){"use strict";function e(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var o=Object.prototype.toString,a=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var n,r=t(e);if("boolean"===r)return"boolean";if("string"===r)return"string";if("number"===r)return"number";if("symbol"===r)return"symbol";if("function"===r)return n=e,"GeneratorFunction"===i(n)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}
/*!
   * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
   *
   * Copyright (c) 2015-present, Jon Schlinkert.
   * Released under the MIT License.
   */(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(i(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(r=o.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")};function i(e){return"function"==typeof e.constructor?e.constructor.name:null}var c=Symbol.prototype.valueOf,u=a;var s=function(e){return null!=e&&"object"===t(e)&&!1===Array.isArray(e)};function l(e){return!0===s(e)&&"[object Object]"===Object.prototype.toString.call(e)}var f=function(e,t){switch(u(e)){case"array":return e.slice();case"object":return Object.assign({},e);case"date":return new e.constructor(Number(e));case"map":return new Map(e);case"set":return new Set(e);case"buffer":return function(e){var t=e.length,n=Buffer.allocUnsafe?Buffer.allocUnsafe(t):Buffer.from(t);return e.copy(n),n}(e);case"symbol":return function(e){return c?Object(c.call(e)):{}}(e);case"arraybuffer":return function(e){var t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}(e);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return function(e,t){return new e.constructor(e.buffer,e.byteOffset,e.length)}(e);case"regexp":return function(e){var t=void 0!==e.flags?e.flags:/\w+$/.exec(e)||void 0,n=new e.constructor(e.source,t);return n.lastIndex=e.lastIndex,n}(e);case"error":return Object.create(e);default:return e}},d=a,p=function(e){var t,n;return!1!==l(e)&&("function"==typeof(t=e.constructor)&&(!1!==l(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))};function h(e,t){switch(d(e)){case"object":return function(e,t){if("function"==typeof t)return t(e);if(t||p(e)){var n=new e.constructor;for(var r in e)n[r]=h(e[r],t);return n}return e}(e,t);case"array":return function(e,t){for(var n=new e.constructor(e.length),r=0;r<e.length;r++)n[r]=h(e[r],t);return n}(e,t);default:return f(e)}}var g=h,m=function(e){return function(e){return!!e&&"object"===t(e)}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===y}(e)}(e)};var y="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function v(e,t){return!1!==t.clone&&t.isMergeableObject(e)?O((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function b(e,t,n){return e.concat(t).map((function(e){return v(e,n)}))}function _(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function w(e,t){try{return t in e}catch(e){return!1}}function x(e,t,n){var r={};return n.isMergeableObject(e)&&_(e).forEach((function(t){r[t]=v(e[t],n)})),_(t).forEach((function(o){(function(e,t){return w(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(w(e,o)&&n.isMergeableObject(t[o])?r[o]=function(e,t){if(!t.customMerge)return O;var n=t.customMerge(e);return"function"==typeof n?n:O}(o,n)(e[o],t[o],n):r[o]=v(t[o],n))})),r}function O(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||b,n.isMergeableObject=n.isMergeableObject||m,n.cloneUnlessOtherwiseSpecified=v;var r=Array.isArray(t);return r===Array.isArray(e)?r?n.arrayMerge(e,t,n):x(e,t,n):v(t,n)}O.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return O(e,n,t)}),{})};var A=O,S=function e(n,r){if(n===r)return!0;if(n&&r&&"object"==t(n)&&"object"==t(r)){if(n.constructor!==r.constructor)return!1;var o,a,i;if(Array.isArray(n)){if((o=n.length)!=r.length)return!1;for(a=o;0!=a--;)if(!e(n[a],r[a]))return!1;return!0}if(n.constructor===RegExp)return n.source===r.source&&n.flags===r.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===r.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===r.toString();if((o=(i=Object.keys(n)).length)!==Object.keys(r).length)return!1;for(a=o;0!=a--;)if(!Object.prototype.hasOwnProperty.call(r,i[a]))return!1;for(a=o;0!=a--;){var c=i[a];if(!e(n[c],r[c]))return!1}return!0}return n!=n&&r!=r};
/*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   */
function j(e){return"[object Object]"===Object.prototype.toString.call(e)}function N(e){var t,n;return!1!==j(e)&&(void 0===(t=e.constructor)||!1!==j(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf"))}var E;var T="undefined"==typeof document?void 0:document,C=!!T&&"content"in T.createElement("template"),I=!!T&&T.createRange&&"createContextualFragment"in T.createRange();function F(e){return e=e.trim(),C?function(e){var t=T.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(e):I?function(e){return E||(E=T.createRange()).selectNode(T.body),E.createContextualFragment(e).childNodes[0]}(e):function(e){var t=T.createElement("body");return t.innerHTML=e,t.childNodes[0]}(e)}function R(e,t){var n,r,o=e.nodeName,a=t.nodeName;return o===a||(n=o.charCodeAt(0),r=a.charCodeAt(0),n<=90&&r>=97?o===a.toUpperCase():r<=90&&n>=97&&a===o.toUpperCase())}function U(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var P={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}U(e,t,"selected")},INPUT:function(e,t){U(e,t,"checked"),U(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var o=r.nodeValue;if(o==n||!n&&o==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,o=-1,a=0,i=e.firstChild;i;)if("OPTGROUP"===(r=i.nodeName&&i.nodeName.toUpperCase()))i=(n=i).firstChild;else{if("OPTION"===r){if(i.hasAttribute("selected")){o=a;break}a++}!(i=i.nextSibling)&&n&&(i=n.nextSibling,n=null)}e.selectedIndex=o}}};function M(){}function k(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var L=function(e){return function(t,n,r){if(r||(r={}),"string"==typeof n)if("#document"===t.nodeName||"HTML"===t.nodeName||"BODY"===t.nodeName){var o=n;(n=T.createElement("html")).innerHTML=o}else n=F(n);var a=r.getNodeKey||k,i=r.onBeforeNodeAdded||M,c=r.onNodeAdded||M,u=r.onBeforeElUpdated||M,s=r.onElUpdated||M,l=r.onBeforeNodeDiscarded||M,f=r.onNodeDiscarded||M,d=r.onBeforeElChildrenUpdated||M,p=!0===r.childrenOnly,h=Object.create(null),g=[];function m(e){g.push(e)}function y(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=a(n))?m(r):(f(n),n.firstChild&&y(n,t)),n=n.nextSibling}}function v(e,t,n){!1!==l(e)&&(t&&t.removeChild(e),f(e),y(e,n))}function b(e){c(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=a(t);if(r){var o=h[r];o&&R(t,o)?(t.parentNode.replaceChild(o,t),_(o,t)):b(t)}else b(t);t=n}}function _(t,n,r){var o=a(n);if(o&&delete h[o],!r){if(!1===u(t,n))return;if(e(t,n),s(t),!1===d(t,n))return}"TEXTAREA"!==t.nodeName?function(e,t){var n,r,o,c,u,s=t.firstChild,l=e.firstChild;e:for(;s;){for(c=s.nextSibling,n=a(s);l;){if(o=l.nextSibling,s.isSameNode&&s.isSameNode(l)){s=c,l=o;continue e}r=a(l);var f=l.nodeType,d=void 0;if(f===s.nodeType&&(1===f?(n?n!==r&&((u=h[n])?o===u?d=!1:(e.insertBefore(u,l),r?m(r):v(l,e,!0),l=u):d=!1):r&&(d=!1),(d=!1!==d&&R(l,s))&&_(l,s)):3!==f&&8!=f||(d=!0,l.nodeValue!==s.nodeValue&&(l.nodeValue=s.nodeValue))),d){s=c,l=o;continue e}r?m(r):v(l,e,!0),l=o}if(n&&(u=h[n])&&R(u,s))e.appendChild(u),_(u,s);else{var p=i(s);!1!==p&&(p&&(s=p),s.actualize&&(s=s.actualize(e.ownerDocument||T)),e.appendChild(s),b(s))}s=c,l=o}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=a(t))?m(n):v(t,e,!0),t=r}}(e,l,r);var g=P[e.nodeName];g&&g(e,t)}(t,n):P.TEXTAREA(t,n)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=a(n);r&&(h[r]=n),e(n),n=n.nextSibling}}(t);var w,x,O=t,A=O.nodeType,S=n.nodeType;if(!p)if(1===A)1===S?R(t,n)||(f(t),O=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(t,(w=n.nodeName,(x=n.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==x?T.createElementNS(x,w):T.createElement(w)))):O=n;else if(3===A||8===A){if(S===A)return O.nodeValue!==n.nodeValue&&(O.nodeValue=n.nodeValue),O;O=n}if(O===n)f(t);else{if(n.isSameNode&&n.isSameNode(O))return;if(_(O,n,p),g)for(var j=0,N=g.length;j<N;j++){var E=h[g[j]];E&&v(E,E.parentNode,!1)}}return!p&&O!==t&&t.parentNode&&(O.actualize&&(O=O.actualize(t.ownerDocument||T)),t.parentNode.replaceChild(O,t)),O}}((function(e,t){var n,r,o,a,i=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var c=i.length-1;c>=0;c--)r=(n=i[c]).name,o=n.namespaceURI,a=n.value,o?(r=n.localName||r,e.getAttributeNS(o,r)!==a&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(o,r,a))):e.getAttribute(r)!==a&&e.setAttribute(r,a);for(var u=e.attributes,s=u.length-1;s>=0;s--)r=(n=u[s]).name,(o=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(o,r)||e.removeAttributeNS(o,r)):t.hasAttribute(r)||e.removeAttribute(r)}})),H=function(e){var t,n=null,r=function(r){return function(){n=null,e.apply(r,t)}},o=function(){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];t=o,null===n&&(n=requestAnimationFrame(r(this)))};return o.cancel=function(){cancelAnimationFrame(n),n=null},o},$={exports:{}};(function(e){function n(e){var t,r,o=new Error(e);return t=o,r=n.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r,o}function r(e,t,r){var o=t.slice(0,r).split(/\n/),a=o.length,i=o[a-1].length+1;throw n(e+=" at line "+a+" col "+i+":\n\n  "+t.split(/\n/)[a-1]+"\n  "+Array(i).join(" ")+"^")}n.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var o=new Function("return this")().Promise,a=!1;try{a=new Function("return (async function(){}).constructor")()}catch(e){if(!(e instanceof SyntaxError))throw e}function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,n,r){for(var o in n)i(n,o)&&(null==n[o]||"object"!=t(n[o])||"storage"!==o&&"prefixes"!==o||r?e[o]=n[o]:e[o]=c({},n[o]));return e}var u=/^async +/,s=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,l=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,f=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g,d=/[.*+\-?^${}()|[\]\\]/g;function p(e){return d.test(e)?e.replace(d,"\\$&"):e}function h(e,t){t.rmWhitespace&&(e=e.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),s.lastIndex=0,l.lastIndex=0,f.lastIndex=0;var o=t.prefixes,a=[o.h,o.b,o.i,o.r,o.c,o.e].reduce((function(e,t){return e&&t?e+"|"+p(t):t?p(t):e}),""),i=new RegExp("([|()]|=>)|('|\"|`|\\/\\*)|\\s*((\\/)?(-|_)?"+p(t.tags[1])+")","g"),c=new RegExp("([^]*?)"+p(t.tags[0])+"(-|_)?\\s*("+a+")?\\s*","g"),d=0,h=!1;function g(n,o){var a,p={f:[]},g=0,m="c";function y(n){var o=e.slice(d,n),a=o.trim();if("f"===m)"safe"===a?p.raw=!0:t.async&&u.test(a)?(a=a.replace(u,""),p.f.push([a,"",!0])):p.f.push([a,""]);else if("fp"===m)p.f[p.f.length-1][1]+=a;else if("err"===m){if(a){var i=o.search(/\S/);r("invalid syntax",e,d+i)}}else p[m]=a;d=n+1}for("h"===o||"b"===o||"c"===o?m="n":"r"===o&&(p.raw=!0,o="i"),i.lastIndex=d;null!==(a=i.exec(e));){var v=a[1],b=a[2],_=a[3],w=a[4],x=a[5],O=a.index;if(v)"("===v?(0===g&&("n"===m?(y(O),m="p"):"f"===m&&(y(O),m="fp")),g++):")"===v?0==--g&&"c"!==m&&(y(O),m="err"):0===g&&"|"===v?(y(O),m="f"):"=>"===v&&(y(O),d+=1,m="res");else if(b)if("/*"===b){var A=e.indexOf("*/",i.lastIndex);-1===A&&r("unclosed comment",e,a.index),i.lastIndex=A+2}else"'"===b?(l.lastIndex=a.index,l.exec(e)?i.lastIndex=l.lastIndex:r("unclosed string",e,a.index)):'"'===b?(f.lastIndex=a.index,f.exec(e)?i.lastIndex=f.lastIndex:r("unclosed string",e,a.index)):"`"===b&&(s.lastIndex=a.index,s.exec(e)?i.lastIndex=s.lastIndex:r("unclosed string",e,a.index));else if(_)return y(O),d=O+a[0].length,c.lastIndex=d,h=x,w&&"h"===o&&(o="s"),p.t=o,p}return r("unclosed tag",e,n),p}var m=function a(i,s){i.b=[],i.d=[];var l,f=!1,p=[];function m(e,n){e&&(e=function(e,t,n,r){var o,a;return"string"==typeof t.autoTrim?o=a=t.autoTrim:Array.isArray(t.autoTrim)&&(o=t.autoTrim[1],a=t.autoTrim[0]),(n||!1===n)&&(o=n),(r||!1===r)&&(a=r),"slurp"===o&&"slurp"===a?e.trim():("_"===o||"slurp"===o?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==o&&"nl"!==o||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===a||"slurp"===a?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==a&&"nl"!==a||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(e,t,h,n))&&(e=e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),p.push(e))}for(;null!==(l=c.exec(e));){var y,v=l[1],b=l[2],_=l[3]||"";for(var w in o)if(o[w]===_){y=w;break}m(v,b),d=l.index+l[0].length,y||r("unrecognized tag type: "+_,e,d);var x=g(l.index,y),O=x.t;if("h"===O){var A=x.n||"";t.async&&u.test(A)&&(x.a=!0,x.n=A.replace(u,"")),x=a(x),p.push(x)}else if("c"===O){if(i.n===x.n)return f?(f.d=p,i.b.push(f)):i.d=p,i;r("Helper start and end don't match",e,l.index+l[0].length)}else if("b"===O){f?(f.d=p,i.b.push(f)):i.d=p;var S=x.n||"";t.async&&u.test(S)&&(x.a=!0,x.n=S.replace(u,"")),f=x,p=[]}else if("s"===O){var j=x.n||"";t.async&&u.test(j)&&(x.a=!0,x.n=j.replace(u,"")),p.push(x)}else p.push(x)}if(!s)throw n('unclosed helper "'+i.n+'"');return m(e.slice(d,e.length),!1),i.d=p,i}({f:[]},!0);if(t.plugins)for(var y=0;y<t.plugins.length;y++){var v=t.plugins[y];v.processAST&&(m.d=v.processAST(m.d,t))}return m.d}function g(e,t){var n=h(e,t),r="var tR='';"+(t.useWith?"with("+t.varName+"||{}){":"")+_(n,t)+"if(cb){cb(null,tR)} return tR"+(t.useWith?"}":"");if(t.plugins)for(var o=0;o<t.plugins.length;o++){var a=t.plugins[o];a.processFnString&&(r=a.processFnString(r,t))}return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n][0],o=t[n][1];e=(t[n][2]?"await ":"")+"c.l('F','"+r+"')("+e,o&&(e+=","+o),e+=")"}return e}function y(e,t,n,r,o,a){var i="{exec:"+(o?"async ":"")+b(n,t,e)+",params:["+r+"]";return a&&(i+=",name:'"+a+"'"),o&&(i+=",async:true"),i+"}"}function v(e,t){for(var n="[",r=0;r<e.length;r++){var o=e[r];n+=y(t,o.res||"",o.d,o.p||"",o.a,o.n),r<e.length&&(n+=",")}return n+"]"}function b(e,t,n){return"function("+t+"){var tR='';"+_(e,n)+"return tR}"}function _(e,t){for(var n=0,r=e.length,o="";n<r;n++){var a=e[n];if("string"==typeof a)o+="tR+='"+a+"';";else{var i=a.t,c=a.c||"",u=a.f,s=a.n||"",l=a.p||"",f=a.res||"",d=a.b,p=!!a.a;if("i"===i){t.defaultFilter&&(c="c.l('F','"+t.defaultFilter+"')("+c+")");var h=m(c,u);!a.raw&&t.autoEscape&&(h="c.l('F','e')("+h+")"),o+="tR+="+h+";"}else if("h"===i)if(t.storage.nativeHelpers.get(s))o+=t.storage.nativeHelpers.get(s)(a,t);else{var g=(p?"await ":"")+"c.l('H','"+s+"')("+y(t,f,a.d,l,p);g+=d?","+v(d,t):",[]",o+="tR+="+m(g+=",c)",u)+";"}else"s"===i?o+="tR+="+m((p?"await ":"")+"c.l('H','"+s+"')({params:["+l+"]},[],c)",u)+";":"e"===i&&(o+=c+"\n")}}return o}var w=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){c(this.cache,e,!0)},e}();function x(e,t,r,o){if(t&&t.length>0)throw n((o?"Native":"")+"Helper '"+e+"' doesn't accept blocks");if(r&&r.length>0)throw n((o?"Native":"")+"Helper '"+e+"' doesn't accept filters")}var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function A(e){return O[e]}var S=new w({}),j=new w({each:function(e,t){var n="",r=e.params[0];if(x("each",t,!1),e.async)return new Promise((function(t){!function e(t,n,r,o,a){r(t[n],n).then((function(i){o+=i,n===t.length-1?a(o):e(t,n+1,r,o,a)}))}(r,0,e.exec,n,t)}));for(var o=0;o<r.length;o++)n+=e.exec(r[o],o);return n},foreach:function(e,t){var n=e.params[0];if(x("foreach",t,!1),e.async)return new Promise((function(t){!function e(t,n,r,o,a,i){o(n[r],t[n[r]]).then((function(c){a+=c,r===n.length-1?i(a):e(t,n,r+1,o,a,i)}))}(n,Object.keys(n),0,e.exec,"",t)}));var r="";for(var o in n)i(n,o)&&(r+=e.exec(o,n[o]));return r},include:function(e,t,r){x("include",t,!1);var o=r.storage.templates.get(e.params[0]);if(!o)throw n('Could not fetch template "'+e.params[0]+'"');return o(e.params[1],r)},extends:function(e,t,r){var o=e.params[1]||{};o.content=e.exec();for(var a=0;a<t.length;a++){var i=t[a];o[i.name]=i.exec()}var c=r.storage.templates.get(e.params[0]);if(!c)throw n('Could not fetch template "'+e.params[0]+'"');return c(o,r)},useScope:function(e,t){return x("useScope",t,!1),e.exec(e.params[0])}}),N=new w({if:function(e,t){x("if",!1,e.f,!0);var n="if("+e.p+"){"+_(e.d,t)+"}";if(e.b)for(var r=0;r<e.b.length;r++){var o=e.b[r];"else"===o.n?n+="else{"+_(o.d,t)+"}":"elif"===o.n&&(n+="else if("+o.p+"){"+_(o.d,t)+"}")}return n},try:function(e,t){if(x("try",!1,e.f,!0),!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw n("native helper 'try' only accepts 1 block, 'catch'");var r="try{"+_(e.d,t)+"}",o=e.b[0];return r+"catch"+(o.res?"("+o.res+")":"")+"{"+_(o.d,t)+"}"},block:function(e,t){return x("block",e.b,e.f,!0),"if(!"+t.varName+"["+e.p+"]){tR+=("+b(e.d,"",t)+")()}else{tR+="+t.varName+"["+e.p+"]}"}}),E=new w({e:function(e){var t=String(e);return/[&<>"']/.test(t)?t.replace(/[&<>"']/g,A):t}}),T={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,t){if("H"===e){var r=this.storage.helpers.get(t);if(r)return r;throw n("Can't find helper '"+t+"'")}if("F"===e){var o=this.storage.filters.get(t);if(o)return o;throw n("Can't find filter '"+t+"'")}},async:!1,storage:{helpers:j,nativeHelpers:N,filters:E,templates:S},prefixes:{h:"@",b:"#",i:"",r:"*",c:"/",e:"!"},cache:!1,plugins:[],useWith:!1};function C(e,t){var n={};return c(n,T),t&&c(n,t),e&&c(n,e),n.l.bind(n),n}function I(e,t){var r=C(t||{}),o=Function;if(r.async){if(!a)throw n("This environment doesn't support async/await");o=a}try{return new o(r.varName,"c","cb",g(e,r))}catch(t){throw t instanceof SyntaxError?n("Bad template syntax\n\n"+t.message+"\n"+Array(t.message.length+1).join("=")+"\n"+g(e,r)):t}}function F(e,t){var n;return t.cache&&t.name&&t.storage.templates.get(t.name)?t.storage.templates.get(t.name):(n="function"==typeof e?e:I(e,t),t.cache&&t.name&&t.storage.templates.define(t.name,n),n)}T.l.bind(T),e.compile=I,e.compileScope=_,e.compileScopeIntoFunction=b,e.compileToString=g,e.defaultConfig=T,e.filters=E,e.getConfig=C,e.helpers=j,e.nativeHelpers=N,e.parse=h,e.render=function(e,t,r,a){var i=C(r||{});if(!i.async)return F(e,i)(t,i);if(!a){if("function"==typeof o)return new o((function(n,r){try{n(F(e,i)(t,i))}catch(e){r(e)}}));throw n("Please provide a callback function, this env doesn't support Promises")}try{F(e,i)(t,i,a)}catch(e){return a(e)}},e.templates=S,Object.defineProperty(e,"__esModule",{value:!0})})($.exports);var D=r($.exports),B=Object.freeze(e({__proto__:null,default:D},[$.exports])),q={};function V(e,t,n,r){var o,a=!1,i=0;function c(){o&&clearTimeout(o)}function u(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];var f=this,d=Date.now()-i;function p(){i=Date.now(),n.apply(f,s)}function h(){o=void 0}a||(r&&!o&&p(),c(),void 0===r&&d>e?p():!0!==t&&(o=setTimeout(r?h:p,void 0===r?e-d:e)))}return"boolean"!=typeof t&&(r=n,n=t,t=void 0),u.cancel=function(){c(),a=!0},u}Object.defineProperty(q,"__esModule",{value:!0}),q.debounce=function(e,t,n){return void 0===n?V(e,t,!1):V(e,n,!1!==t)};var W=q.throttle=V;return function(){function e(e){var t=this;this._initialConfig={$element:document.body,deepmerge:{isMergeableObject:N},delegations:{},filters:{},helpers:{},initialState:{},load:function(){},morphdom:{onBeforeElUpdated:function(e,t){return!e.isEqualNode(t)}},nativeHelpers:{},nonBubblingEvents:["abort","blur","error","focus","load","loadend","loadstart","pointerenter","pointerleave","progress","scroll","unload"],partials:{},shouldUpdate:function(e,t){return!S(e,t)},squirrelly:$.exports.defaultConfig,template:"",unload:function(){},update:function(){}},this._enforcedConfig={deepmerge:{clone:!1},morphdom:{childrenOnly:!1},squirrelly:{varName:"state"}},this._delegationFuncs={},this._loaded=!1,this._state={},this._throttledLoadOrUpdate=H(this._loadOrUpdate),this._throttledRender=H(this._render),this._config=A.all([this._initialConfig,g(e),this._enforcedConfig],n(n({},this._initialConfig.deepmerge),this._enforcedConfig.deepmerge)),N(this._config.initialState)&&null!==this._config.initialState?(["filters","helpers","nativeHelpers"].forEach((function(e){Object.keys(t._config[e]).forEach((function(n){B[e].define(n,t._config[e][n])}))})),Object.keys(this._config.partials).forEach((function(e){$.exports.templates.define(e,$.exports.compile(t._getTemplate(t._config.partials[e]),n(n({},t._config.squirrelly),{varName:"partialState"})))})),this._compiledTemplate=$.exports.compile(this._getTemplate(this._config.template),this._config.squirrelly),Object.keys(this._config.delegations).forEach((function(e,n){e.split(/\s*,\s*/g).forEach((function(r){var o="".concat(r,":").concat(n);if(o in t._delegationFuncs)console.warn('RIsland: event name "'.concat(r,'" exists more than once in "').concat(e,'". This occurence will simply be ignored.'));else{var a=t._getThrottling(r);t._delegationFuncs[o]={capture:-1!==t._config.nonBubblingEvents.indexOf(a.eventName),func:function(n){n.target instanceof Element&&Object.keys(t._config.delegations[e]).forEach((function(r){var o=n.target.closest(r);null!==o&&t._config.delegations[e][r](n,o,g(t._state),t._setState.bind(t))}))}},!0===a.throttled&&(t._delegationFuncs[o].func="ms"in a?W(a.ms,t._delegationFuncs[o].func):H(t._delegationFuncs[o].func)),t._config.$element.addEventListener(a.eventName,t._delegationFuncs[o].func,{capture:t._delegationFuncs[o].capture})}}))})),0===Object.keys(this._config.initialState).length?(console.warn("RIsland: Initialisation with an empty state is considered an anti-pattern. Please try to predefine everything you will later change with setState() with an initial value; even it is null."),this._throttledRender()):this._setState(this._config.initialState)):console.error("RIsland: initialState has to be an object (which is not null).")}return e.prototype.unload=function(){var e=this;Object.keys(this._delegationFuncs).forEach((function(t){e._config.$element.removeEventListener(t.split(/:/g)[0],e._delegationFuncs[t].func,{capture:e._delegationFuncs[t].capture})})),this._config.$element.innerHTML="",this._config.unload(g(this._state))},e.prototype._setState=function(e){var t=this,n="function"==typeof e?e(g(this._state)):e;if(null!==n)if(n instanceof Promise)n.then((function(e){return t._setState(e)}));else if(Array.isArray(n))n.forEach((function(e){return t._setState(e)}));else{var r="customMerge"in this._config.deepmerge?A(g(this._state),n,this._config.deepmerge):A(this._state,n,this._config.deepmerge),o=this._config.shouldUpdate===this._initialConfig.shouldUpdate?this._config.shouldUpdate(this._state,r):this._config.shouldUpdate(g(this._state),"customMerge"in this._config.deepmerge?r:g(r));this._state=r,!0===o&&this._throttledRender()}},e.prototype._render=function(){var e=this;!1!==this._loaded&&null!==this._config.$element.firstChild||(this._config.$element.innerHTML="<div></div>"),L(this._config.$element.firstChild,this._compiledTemplate(this._state,this._config.squirrelly),n(n({},this._config.morphdom),{onElUpdated:function(t){e._throttledLoadOrUpdate(),"onElUpdated"in e._config.morphdom&&e._config.morphdom.onElUpdated(t)},onNodeAdded:function(t){return e._throttledLoadOrUpdate(),"onNodeAdded"in e._config.morphdom?e._config.morphdom.onNodeAdded(t):t},onNodeDiscarded:function(t){return e._throttledLoadOrUpdate(),"onNodeDiscarded"in e._config.morphdom?e._config.morphdom.onNodeDiscarded(t):t}}))},e.prototype._getTemplate=function(e){if("string"==typeof e)return e;if("object"===t(e)){if(e instanceof HTMLScriptElement)return e.innerHTML;if("content"in e&&e.content instanceof DocumentFragment){if(!1===this._checkWrapping(e.content)){var n="RIsland: First element in the template must be a single element, without any siblings. The content should at least be wrapped in a div-tag.";return console.error(n),'<p style="color:red;">'.concat(n,"</p>")}var r=document.createElement("textarea");return r.innerHTML=Array.from(e.content.childNodes).map((function(e){return e.outerHTML})).join(""),r.value}}var o="RIsland: template must be a string, a template tag element or a script tag element.";return console.error(o),'<p style="color:red;">'.concat(o,"</p>")},e.prototype._checkWrapping=function(e){return 1===Array.from(e.childNodes).filter((function(e){return e instanceof Element})).length},e.prototype._getThrottling=function(e){var t=e.split(/\./g),n=t[0];if(t.length>1&&"throttled"===t[1]){if(3===t.length){var r=parseInt(t[2],10);if(!isNaN(r))return{eventName:n,ms:r,throttled:!0};console.warn('RIsland: event name "'.concat(e,'" is malformed. The milliseconds "').concat(t[2],'" are not a valid number. falling back to request animation frame.'))}return{eventName:n,throttled:!0}}return{eventName:n,throttled:!1}},e.prototype._loadOrUpdate=function(){var e=g(this._state);!1===this._loaded?(this._loaded=!0,this._config.load(e,this._setState.bind(this))):this._config.update(e,this._setState.bind(this))},e}()}();
