/**
 * @license
 * author: Stefan Jelner
 * risland.js v0.0.5
 * Released under the ISC license.
 * 
 * See https://github.com/StefanJelner/risland.js.git
 */
var RIsland=function(){"use strict";function e(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i=Object.prototype.toString,o=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var r,n=t(e);if("boolean"===n)return"boolean";if("string"===n)return"string";if("number"===n)return"number";if("symbol"===n)return"symbol";if("function"===n)return r=e,"GeneratorFunction"===a(r)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}
/*!
   * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
   *
   * Copyright (c) 2015-present, Jon Schlinkert.
   * Released under the MIT License.
   */(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(a(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(n=i.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return n.slice(8,-1).toLowerCase().replace(/\s/g,"")};function a(e){return"function"==typeof e.constructor?e.constructor.name:null}var c=Symbol.prototype.valueOf,s=o;var u=function(e){return null!=e&&"object"===t(e)&&!1===Array.isArray(e)};function l(e){return!0===u(e)&&"[object Object]"===Object.prototype.toString.call(e)}var f=function(e,t){switch(s(e)){case"array":return e.slice();case"object":return Object.assign({},e);case"date":return new e.constructor(Number(e));case"map":return new Map(e);case"set":return new Set(e);case"buffer":return function(e){var t=e.length,r=Buffer.allocUnsafe?Buffer.allocUnsafe(t):Buffer.from(t);return e.copy(r),r}(e);case"symbol":return function(e){return c?Object(c.call(e)):{}}(e);case"arraybuffer":return function(e){var t=new e.constructor(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}(e);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return function(e,t){return new e.constructor(e.buffer,e.byteOffset,e.length)}(e);case"regexp":return function(e){var t=void 0!==e.flags?e.flags:/\w+$/.exec(e)||void 0,r=new e.constructor(e.source,t);return r.lastIndex=e.lastIndex,r}(e);case"error":return Object.create(e);default:return e}},d=o,p=function(e){var t,r;return!1!==l(e)&&("function"==typeof(t=e.constructor)&&(!1!==l(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))};function h(e,t){switch(d(e)){case"object":return function(e,t){if("function"==typeof t)return t(e);if(t||p(e)){var r=new e.constructor;for(var n in e)r[n]=h(e[n],t);return r}return e}(e,t);case"array":return function(e,t){for(var r=new e.constructor(e.length),n=0;n<e.length;n++)r[n]=h(e[n],t);return r}(e,t);default:return f(e)}}var g=h,m=function(e){return function(e){return!!e&&"object"===t(e)}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===y}(e)}(e)};var y="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function v(e,t){return!1!==t.clone&&t.isMergeableObject(e)?x((r=e,Array.isArray(r)?[]:{}),e,t):e;var r}function b(e,t,r){return e.concat(t).map((function(e){return v(e,r)}))}function _(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function w(e,t){try{return t in e}catch(e){return!1}}function O(e,t,r){var n={};return r.isMergeableObject(e)&&_(e).forEach((function(t){n[t]=v(e[t],r)})),_(t).forEach((function(i){(function(e,t){return w(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(w(e,i)&&r.isMergeableObject(t[i])?n[i]=function(e,t){if(!t.customMerge)return x;var r=t.customMerge(e);return"function"==typeof r?r:x}(i,r)(e[i],t[i],r):n[i]=v(t[i],r))})),n}function x(e,t,r){(r=r||{}).arrayMerge=r.arrayMerge||b,r.isMergeableObject=r.isMergeableObject||m,r.cloneUnlessOtherwiseSpecified=v;var n=Array.isArray(t);return n===Array.isArray(e)?n?r.arrayMerge(e,t,r):O(e,t,r):v(t,r)}x.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,r){return x(e,r,t)}),{})};var S=x,A=function e(r,n){if(r===n)return!0;if(r&&n&&"object"==t(r)&&"object"==t(n)){if(r.constructor!==n.constructor)return!1;var i,o,a;if(Array.isArray(r)){if((i=r.length)!=n.length)return!1;for(o=i;0!=o--;)if(!e(r[o],n[o]))return!1;return!0}if(r.constructor===RegExp)return r.source===n.source&&r.flags===n.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===n.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===n.toString();if((i=(a=Object.keys(r)).length)!==Object.keys(n).length)return!1;for(o=i;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,a[o]))return!1;for(o=i;0!=o--;){var c=a[o];if(!e(r[c],n[c]))return!1}return!0}return r!=r&&n!=n};
/*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   */
function N(e){return"[object Object]"===Object.prototype.toString.call(e)}function E(e){var t,r;return!1!==N(e)&&(void 0===(t=e.constructor)||!1!==N(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf"))}var j;var T="undefined"==typeof document?void 0:document,C=!!T&&"content"in T.createElement("template"),R=!!T&&T.createRange&&"createContextualFragment"in T.createRange();function U(e){return e=e.trim(),C?function(e){var t=T.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(e):R?function(e){return j||(j=T.createRange()).selectNode(T.body),j.createContextualFragment(e).childNodes[0]}(e):function(e){var t=T.createElement("body");return t.innerHTML=e,t.childNodes[0]}(e)}function I(e,t){var r,n,i=e.nodeName,o=t.nodeName;return i===o||(r=i.charCodeAt(0),n=o.charCodeAt(0),r<=90&&n>=97?i===o.toUpperCase():n<=90&&r>=97&&o===i.toUpperCase())}function F(e,t,r){e[r]!==t[r]&&(e[r]=t[r],e[r]?e.setAttribute(r,""):e.removeAttribute(r))}var M={OPTION:function(e,t){var r=e.parentNode;if(r){var n=r.nodeName.toUpperCase();"OPTGROUP"===n&&(n=(r=r.parentNode)&&r.nodeName.toUpperCase()),"SELECT"!==n||r.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),r.selectedIndex=-1)}F(e,t,"selected")},INPUT:function(e,t){F(e,t,"checked"),F(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var r=t.value;e.value!==r&&(e.value=r);var n=e.firstChild;if(n){var i=n.nodeValue;if(i==r||!r&&i==e.placeholder)return;n.nodeValue=r}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var r,n,i=-1,o=0,a=e.firstChild;a;)if("OPTGROUP"===(n=a.nodeName&&a.nodeName.toUpperCase()))a=(r=a).firstChild;else{if("OPTION"===n){if(a.hasAttribute("selected")){i=o;break}o++}!(a=a.nextSibling)&&r&&(a=r.nextSibling,r=null)}e.selectedIndex=i}}};function P(){}function k(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var L=function(e){return function(t,r,n){if(n||(n={}),"string"==typeof r)if("#document"===t.nodeName||"HTML"===t.nodeName||"BODY"===t.nodeName){var i=r;(r=T.createElement("html")).innerHTML=i}else r=U(r);var o=n.getNodeKey||k,a=n.onBeforeNodeAdded||P,c=n.onNodeAdded||P,s=n.onBeforeElUpdated||P,u=n.onElUpdated||P,l=n.onBeforeNodeDiscarded||P,f=n.onNodeDiscarded||P,d=n.onBeforeElChildrenUpdated||P,p=!0===n.childrenOnly,h=Object.create(null),g=[];function m(e){g.push(e)}function y(e,t){if(1===e.nodeType)for(var r=e.firstChild;r;){var n=void 0;t&&(n=o(r))?m(n):(f(r),r.firstChild&&y(r,t)),r=r.nextSibling}}function v(e,t,r){!1!==l(e)&&(t&&t.removeChild(e),f(e),y(e,r))}function b(e){c(e);for(var t=e.firstChild;t;){var r=t.nextSibling,n=o(t);if(n){var i=h[n];i&&I(t,i)?(t.parentNode.replaceChild(i,t),_(i,t)):b(t)}else b(t);t=r}}function _(t,r,n){var i=o(r);if(i&&delete h[i],!n){if(!1===s(t,r))return;if(e(t,r),u(t),!1===d(t,r))return}"TEXTAREA"!==t.nodeName?function(e,t){var r,n,i,c,s,u=t.firstChild,l=e.firstChild;e:for(;u;){for(c=u.nextSibling,r=o(u);l;){if(i=l.nextSibling,u.isSameNode&&u.isSameNode(l)){u=c,l=i;continue e}n=o(l);var f=l.nodeType,d=void 0;if(f===u.nodeType&&(1===f?(r?r!==n&&((s=h[r])?i===s?d=!1:(e.insertBefore(s,l),n?m(n):v(l,e,!0),l=s):d=!1):n&&(d=!1),(d=!1!==d&&I(l,u))&&_(l,u)):3!==f&&8!=f||(d=!0,l.nodeValue!==u.nodeValue&&(l.nodeValue=u.nodeValue))),d){u=c,l=i;continue e}n?m(n):v(l,e,!0),l=i}if(r&&(s=h[r])&&I(s,u))e.appendChild(s),_(s,u);else{var p=a(u);!1!==p&&(p&&(u=p),u.actualize&&(u=u.actualize(e.ownerDocument||T)),e.appendChild(u),b(u))}u=c,l=i}!function(e,t,r){for(;t;){var n=t.nextSibling;(r=o(t))?m(r):v(t,e,!0),t=n}}(e,l,n);var g=M[e.nodeName];g&&g(e,t)}(t,r):M.TEXTAREA(t,r)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var r=t.firstChild;r;){var n=o(r);n&&(h[n]=r),e(r),r=r.nextSibling}}(t);var w,O,x=t,S=x.nodeType,A=r.nodeType;if(!p)if(1===S)1===A?I(t,r)||(f(t),x=function(e,t){for(var r=e.firstChild;r;){var n=r.nextSibling;t.appendChild(r),r=n}return t}(t,(w=r.nodeName,(O=r.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==O?T.createElementNS(O,w):T.createElement(w)))):x=r;else if(3===S||8===S){if(A===S)return x.nodeValue!==r.nodeValue&&(x.nodeValue=r.nodeValue),x;x=r}if(x===r)f(t);else{if(r.isSameNode&&r.isSameNode(x))return;if(_(x,r,p),g)for(var N=0,E=g.length;N<E;N++){var j=h[g[N]];j&&v(j,j.parentNode,!1)}}return!p&&x!==t&&t.parentNode&&(x.actualize&&(x=x.actualize(t.ownerDocument||T)),t.parentNode.replaceChild(x,t)),x}}((function(e,t){var r,n,i,o,a=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var c=a.length-1;c>=0;c--)n=(r=a[c]).name,i=r.namespaceURI,o=r.value,i?(n=r.localName||n,e.getAttributeNS(i,n)!==o&&("xmlns"===r.prefix&&(n=r.name),e.setAttributeNS(i,n,o))):e.getAttribute(n)!==o&&e.setAttribute(n,o);for(var s=e.attributes,u=s.length-1;u>=0;u--)n=(r=s[u]).name,(i=r.namespaceURI)?(n=r.localName||n,t.hasAttributeNS(i,n)||e.removeAttributeNS(i,n)):t.hasAttribute(n)||e.removeAttribute(n)}})),B=function(e){var t,r=null,n=function(n){return function(){r=null,e.apply(n,t)}},i=function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];t=i,null===r&&(r=requestAnimationFrame(n(this)))};return i.cancel=function(){cancelAnimationFrame(r),r=null},i},H={exports:{}};(function(e){function r(e){var t,n,i=new Error(e);return t=i,n=r.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n,i}function n(e,t,n){var i=t.slice(0,n).split(/\n/),o=i.length,a=i[o-1].length+1;throw r(e+=" at line "+o+" col "+a+":\n\n  "+t.split(/\n/)[o-1]+"\n  "+Array(a).join(" ")+"^")}r.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var i=new Function("return this")().Promise,o=!1;try{o=new Function("return (async function(){}).constructor")()}catch(e){if(!(e instanceof SyntaxError))throw e}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,r,n){for(var i in r)a(r,i)&&(null==r[i]||"object"!=t(r[i])||"storage"!==i&&"prefixes"!==i||n?e[i]=r[i]:e[i]=c({},r[i]));return e}var s=/^async +/,u=/`(?:\\[\s\S]|\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})*}|(?!\${)[^\\`])*`/g,l=/'(?:\\[\s\w"'\\`]|[^\n\r'\\])*?'/g,f=/"(?:\\[\s\w"'\\`]|[^\n\r"\\])*?"/g,d=/[.*+\-?^${}()|[\]\\]/g;function p(e){return d.test(e)?e.replace(d,"\\$&"):e}function h(e,t){t.rmWhitespace&&(e=e.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),u.lastIndex=0,l.lastIndex=0,f.lastIndex=0;var i=t.prefixes,o=[i.h,i.b,i.i,i.r,i.c,i.e].reduce((function(e,t){return e&&t?e+"|"+p(t):t?p(t):e}),""),a=new RegExp("([|()]|=>)|('|\"|`|\\/\\*)|\\s*((\\/)?(-|_)?"+p(t.tags[1])+")","g"),c=new RegExp("([^]*?)"+p(t.tags[0])+"(-|_)?\\s*("+o+")?\\s*","g"),d=0,h=!1;function g(r,i){var o,p={f:[]},g=0,m="c";function y(r){var i=e.slice(d,r),o=i.trim();if("f"===m)"safe"===o?p.raw=!0:t.async&&s.test(o)?(o=o.replace(s,""),p.f.push([o,"",!0])):p.f.push([o,""]);else if("fp"===m)p.f[p.f.length-1][1]+=o;else if("err"===m){if(o){var a=i.search(/\S/);n("invalid syntax",e,d+a)}}else p[m]=o;d=r+1}for("h"===i||"b"===i||"c"===i?m="n":"r"===i&&(p.raw=!0,i="i"),a.lastIndex=d;null!==(o=a.exec(e));){var v=o[1],b=o[2],_=o[3],w=o[4],O=o[5],x=o.index;if(v)"("===v?(0===g&&("n"===m?(y(x),m="p"):"f"===m&&(y(x),m="fp")),g++):")"===v?0==--g&&"c"!==m&&(y(x),m="err"):0===g&&"|"===v?(y(x),m="f"):"=>"===v&&(y(x),d+=1,m="res");else if(b)if("/*"===b){var S=e.indexOf("*/",a.lastIndex);-1===S&&n("unclosed comment",e,o.index),a.lastIndex=S+2}else"'"===b?(l.lastIndex=o.index,l.exec(e)?a.lastIndex=l.lastIndex:n("unclosed string",e,o.index)):'"'===b?(f.lastIndex=o.index,f.exec(e)?a.lastIndex=f.lastIndex:n("unclosed string",e,o.index)):"`"===b&&(u.lastIndex=o.index,u.exec(e)?a.lastIndex=u.lastIndex:n("unclosed string",e,o.index));else if(_)return y(x),d=x+o[0].length,c.lastIndex=d,h=O,w&&"h"===i&&(i="s"),p.t=i,p}return n("unclosed tag",e,r),p}var m=function o(a,u){a.b=[],a.d=[];var l,f=!1,p=[];function m(e,r){e&&(e=function(e,t,r,n){var i,o;return"string"==typeof t.autoTrim?i=o=t.autoTrim:Array.isArray(t.autoTrim)&&(i=t.autoTrim[1],o=t.autoTrim[0]),(r||!1===r)&&(i=r),(n||!1===n)&&(o=n),"slurp"===i&&"slurp"===o?e.trim():("_"===i||"slurp"===i?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==i&&"nl"!==i||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===o||"slurp"===o?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==o&&"nl"!==o||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(e,t,h,r))&&(e=e.replace(/\\|'/g,"\\$&").replace(/\r\n|\n|\r/g,"\\n"),p.push(e))}for(;null!==(l=c.exec(e));){var y,v=l[1],b=l[2],_=l[3]||"";for(var w in i)if(i[w]===_){y=w;break}m(v,b),d=l.index+l[0].length,y||n("unrecognized tag type: "+_,e,d);var O=g(l.index,y),x=O.t;if("h"===x){var S=O.n||"";t.async&&s.test(S)&&(O.a=!0,O.n=S.replace(s,"")),O=o(O),p.push(O)}else if("c"===x){if(a.n===O.n)return f?(f.d=p,a.b.push(f)):a.d=p,a;n("Helper start and end don't match",e,l.index+l[0].length)}else if("b"===x){f?(f.d=p,a.b.push(f)):a.d=p;var A=O.n||"";t.async&&s.test(A)&&(O.a=!0,O.n=A.replace(s,"")),f=O,p=[]}else if("s"===x){var N=O.n||"";t.async&&s.test(N)&&(O.a=!0,O.n=N.replace(s,"")),p.push(O)}else p.push(O)}if(!u)throw r('unclosed helper "'+a.n+'"');return m(e.slice(d,e.length),!1),a.d=p,a}({f:[]},!0);if(t.plugins)for(var y=0;y<t.plugins.length;y++){var v=t.plugins[y];v.processAST&&(m.d=v.processAST(m.d,t))}return m.d}function g(e,t){var r=h(e,t),n="var tR='';"+(t.useWith?"with("+t.varName+"||{}){":"")+_(r,t)+"if(cb){cb(null,tR)} return tR"+(t.useWith?"}":"");if(t.plugins)for(var i=0;i<t.plugins.length;i++){var o=t.plugins[i];o.processFnString&&(n=o.processFnString(n,t))}return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r][0],i=t[r][1];e=(t[r][2]?"await ":"")+"c.l('F','"+n+"')("+e,i&&(e+=","+i),e+=")"}return e}function y(e,t,r,n,i,o){var a="{exec:"+(i?"async ":"")+b(r,t,e)+",params:["+n+"]";return o&&(a+=",name:'"+o+"'"),i&&(a+=",async:true"),a+"}"}function v(e,t){for(var r="[",n=0;n<e.length;n++){var i=e[n];r+=y(t,i.res||"",i.d,i.p||"",i.a,i.n),n<e.length&&(r+=",")}return r+"]"}function b(e,t,r){return"function("+t+"){var tR='';"+_(e,r)+"return tR}"}function _(e,t){for(var r=0,n=e.length,i="";r<n;r++){var o=e[r];if("string"==typeof o)i+="tR+='"+o+"';";else{var a=o.t,c=o.c||"",s=o.f,u=o.n||"",l=o.p||"",f=o.res||"",d=o.b,p=!!o.a;if("i"===a){t.defaultFilter&&(c="c.l('F','"+t.defaultFilter+"')("+c+")");var h=m(c,s);!o.raw&&t.autoEscape&&(h="c.l('F','e')("+h+")"),i+="tR+="+h+";"}else if("h"===a)if(t.storage.nativeHelpers.get(u))i+=t.storage.nativeHelpers.get(u)(o,t);else{var g=(p?"await ":"")+"c.l('H','"+u+"')("+y(t,f,o.d,l,p);g+=d?","+v(d,t):",[]",i+="tR+="+m(g+=",c)",s)+";"}else"s"===a?i+="tR+="+m((p?"await ":"")+"c.l('H','"+u+"')({params:["+l+"]},[],c)",s)+";":"e"===a&&(i+=c+"\n")}}return i}var w=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){c(this.cache,e,!0)},e}();function O(e,t,n,i){if(t&&t.length>0)throw r((i?"Native":"")+"Helper '"+e+"' doesn't accept blocks");if(n&&n.length>0)throw r((i?"Native":"")+"Helper '"+e+"' doesn't accept filters")}var x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function S(e){return x[e]}var A=new w({}),N=new w({each:function(e,t){var r="",n=e.params[0];if(O("each",t,!1),e.async)return new Promise((function(t){!function e(t,r,n,i,o){n(t[r],r).then((function(a){i+=a,r===t.length-1?o(i):e(t,r+1,n,i,o)}))}(n,0,e.exec,r,t)}));for(var i=0;i<n.length;i++)r+=e.exec(n[i],i);return r},foreach:function(e,t){var r=e.params[0];if(O("foreach",t,!1),e.async)return new Promise((function(t){!function e(t,r,n,i,o,a){i(r[n],t[r[n]]).then((function(c){o+=c,n===r.length-1?a(o):e(t,r,n+1,i,o,a)}))}(r,Object.keys(r),0,e.exec,"",t)}));var n="";for(var i in r)a(r,i)&&(n+=e.exec(i,r[i]));return n},include:function(e,t,n){O("include",t,!1);var i=n.storage.templates.get(e.params[0]);if(!i)throw r('Could not fetch template "'+e.params[0]+'"');return i(e.params[1],n)},extends:function(e,t,n){var i=e.params[1]||{};i.content=e.exec();for(var o=0;o<t.length;o++){var a=t[o];i[a.name]=a.exec()}var c=n.storage.templates.get(e.params[0]);if(!c)throw r('Could not fetch template "'+e.params[0]+'"');return c(i,n)},useScope:function(e,t){return O("useScope",t,!1),e.exec(e.params[0])}}),E=new w({if:function(e,t){O("if",!1,e.f,!0);var r="if("+e.p+"){"+_(e.d,t)+"}";if(e.b)for(var n=0;n<e.b.length;n++){var i=e.b[n];"else"===i.n?r+="else{"+_(i.d,t)+"}":"elif"===i.n&&(r+="else if("+i.p+"){"+_(i.d,t)+"}")}return r},try:function(e,t){if(O("try",!1,e.f,!0),!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw r("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+_(e.d,t)+"}",i=e.b[0];return n+"catch"+(i.res?"("+i.res+")":"")+"{"+_(i.d,t)+"}"},block:function(e,t){return O("block",e.b,e.f,!0),"if(!"+t.varName+"["+e.p+"]){tR+=("+b(e.d,"",t)+")()}else{tR+="+t.varName+"["+e.p+"]}"}}),j=new w({e:function(e){var t=String(e);return/[&<>"']/.test(t)?t.replace(/[&<>"']/g,S):t}}),T={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,t){if("H"===e){var n=this.storage.helpers.get(t);if(n)return n;throw r("Can't find helper '"+t+"'")}if("F"===e){var i=this.storage.filters.get(t);if(i)return i;throw r("Can't find filter '"+t+"'")}},async:!1,storage:{helpers:N,nativeHelpers:E,filters:j,templates:A},prefixes:{h:"@",b:"#",i:"",r:"*",c:"/",e:"!"},cache:!1,plugins:[],useWith:!1};function C(e,t){var r={};return c(r,T),t&&c(r,t),e&&c(r,e),r.l.bind(r),r}function R(e,t){var n=C(t||{}),i=Function;if(n.async){if(!o)throw r("This environment doesn't support async/await");i=o}try{return new i(n.varName,"c","cb",g(e,n))}catch(t){throw t instanceof SyntaxError?r("Bad template syntax\n\n"+t.message+"\n"+Array(t.message.length+1).join("=")+"\n"+g(e,n)):t}}function U(e,t){var r;return t.cache&&t.name&&t.storage.templates.get(t.name)?t.storage.templates.get(t.name):(r="function"==typeof e?e:R(e,t),t.cache&&t.name&&t.storage.templates.define(t.name,r),r)}T.l.bind(T),e.compile=R,e.compileScope=_,e.compileScopeIntoFunction=b,e.compileToString=g,e.defaultConfig=T,e.filters=j,e.getConfig=C,e.helpers=N,e.nativeHelpers=E,e.parse=h,e.render=function(e,t,n,o){var a=C(n||{});if(!a.async)return U(e,a)(t,a);if(!o){if("function"==typeof i)return new i((function(r,n){try{r(U(e,a)(t,a))}catch(e){n(e)}}));throw r("Please provide a callback function, this env doesn't support Promises")}try{U(e,a)(t,a,o)}catch(e){return o(e)}},e.templates=A,Object.defineProperty(e,"__esModule",{value:!0})})(H.exports);var $=n(H.exports),q=Object.freeze(e({__proto__:null,default:$},[H.exports])),D={};function V(e,t,r,n){var i,o=!1,a=0;function c(){i&&clearTimeout(i)}function s(){for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];var f=this,d=Date.now()-a;function p(){a=Date.now(),r.apply(f,u)}function h(){i=void 0}o||(n&&!i&&p(),c(),void 0===n&&d>e?p():!0!==t&&(i=setTimeout(n?h:p,void 0===n?e-d:e)))}return"boolean"!=typeof t&&(n=r,r=t,t=void 0),s.cancel=function(){c(),o=!0},s}Object.defineProperty(D,"__esModule",{value:!0}),D.debounce=function(e,t,r){return void 0===r?V(e,t,!1):V(e,r,!1!==t)};var W=D.throttle=V;return function(){function e(t){var n=this;this._empty="<div></div>",this._initialConfig={$element:document.body,deepmerge:{isMergeableObject:E},delegations:{},error:function(){},filters:{},helpers:{},initialState:{},load:function(){},morphdom:{},nativeHelpers:{},nonBubblingEvents:e.NON_BUBBLING_EVENTS,partials:{},shouldUpdate:function(e,t){return!A(e,t)},squirrelly:H.exports.defaultConfig,template:this._empty,unload:function(){},update:function(){}},this._enforcedConfig={deepmerge:{clone:!1},morphdom:{childrenOnly:!1},squirrelly:{varName:"state"}},this._internalSqrlConfig=r(r({},H.exports.defaultConfig),this._enforcedConfig.squirrelly),this._compiledConsole=H.exports.compile("{{state.type}}:\n\n{{@each(state.messages) => message}}- {{message}}\n{{/each}}",this._internalSqrlConfig),this._compiledError=H.exports.compile('<ul style="color:red;">{{@each(state.errors) => error}}<li>{{error}}</li>{{/each}}</ul>',this._internalSqrlConfig),this._delegationFuncs={},this._errors=[],this._loaded=!1,this._state={},this._throttledLoadOrUpdate=B(this._loadOrUpdate),this._throttledRender=B(this._render),this._warnings=[],this._config=S.all([this._initialConfig,g(t),this._enforcedConfig],r(r({},this._initialConfig.deepmerge),this._enforcedConfig.deepmerge)),E(this._config.initialState)&&null!==this._config.initialState||(this._errors=this._errors.concat("ERR001: initialState has to be an object (which is not null)."),this._config.initialState=this._initialConfig.initialState),["filters","helpers","nativeHelpers"].forEach((function(e){Object.keys(n._config[e]).forEach((function(t){q[e].define(t,n._config[e][t])}))})),Object.keys(this._config.partials).forEach((function(e){H.exports.templates.define(e,H.exports.compile(n._getTemplate(n._config.partials[e]),r(r({},n._config.squirrelly),{varName:"partialState"})))})),this._compiledTemplate=H.exports.compile(this._getTemplate(this._config.template),this._config.squirrelly),Object.keys(this._config.delegations).forEach((function(e,t){e.trim().split(/\s*,\s*/g).forEach((function(r){var i="".concat(r,":").concat(t);if(i in n._delegationFuncs)n._warnings=n._warnings.concat('WARN001: RIsland: event name "'.concat(r,'" exists more than once in "').concat(e,'". This occurence will simply be ignored.'));else{var o=n._getThrottling(r);n._delegationFuncs[i]={capture:-1!==n._config.nonBubblingEvents.indexOf(o.eventName),func:function(t){t.target instanceof Element&&Object.keys(n._config.delegations[e]).forEach((function(r){var i=t.target.closest(r);null!==i&&n._config.delegations[e][r](t,i,g(n._state),n._setState.bind(n))}))}},!0===o.throttled&&(n._delegationFuncs[i].func="ms"in o?W(o.ms,n._delegationFuncs[i].func):B(n._delegationFuncs[i].func)),n._config.$element.addEventListener(o.eventName,n._delegationFuncs[i].func,{capture:n._delegationFuncs[i].capture})}}))})),0===Object.keys(this._config.initialState).length?(this._warnings=this._warnings.concat("WARN002: Initialisation with an empty state is considered an anti-pattern. Please try to predefine everything you will later change with setState() with an initial value; even it is null."),this._throttledRender()):this._setState(this._config.initialState)}return e.prototype.unload=function(){var e=this;Object.keys(this._delegationFuncs).forEach((function(t){e._config.$element.removeEventListener(t.split(/:/g)[0],e._delegationFuncs[t].func,{capture:e._delegationFuncs[t].capture})})),this._config.$element.innerHTML="",this._config.unload(g(this._state))},e.prototype._setState=function(e){var t=this,r="function"==typeof e?e(g(this._state)):e;if(null!==r)if(r instanceof Promise)r.then((function(e){return t._setState(e)}));else if(Array.isArray(r))r.forEach((function(e){return t._setState(e)}));else{var n="customMerge"in this._config.deepmerge?S(g(this._state),r,this._config.deepmerge):S(this._state,r,this._config.deepmerge),i=this._config.shouldUpdate===this._initialConfig.shouldUpdate?this._config.shouldUpdate(this._state,n):this._config.shouldUpdate(g(this._state),"customMerge"in this._config.deepmerge?n:g(n));this._state=n,!0===i&&this._throttledRender()}},e.prototype._render=function(){var e=this,t=this._checkTemplate(this._compiledTemplate(this._state,this._config.squirrelly).trim());if(this._warnings.length>0&&(console.warn(this._compiledConsole({messages:this._warnings,type:"Warnings"},this._internalSqrlConfig)),this._warnings=[]),this._errors.length>0)return this._config.$element.innerHTML=this._compiledError({errors:this._errors},this._internalSqrlConfig),console.error(this._compiledConsole({messages:this._errors,type:"Errors"},this._internalSqrlConfig)),this._errors=[],void this._config.error();!1!==this._loaded&&1===this._config.$element.children.length||(this._config.$element.innerHTML=this._empty),!1!==this._loaded||this._config.$element.innerHTML!==t?L(this._config.$element.firstChild,t,r(r({},this._config.morphdom),{onBeforeElUpdated:function(t,r){return(!("onBeforeElUpdated"in e._config.morphdom)||!1!==e._config.morphdom.onBeforeElUpdated(t,r))&&!t.isEqualNode(r)},onElUpdated:function(t){e._throttledLoadOrUpdate(),"onElUpdated"in e._config.morphdom&&e._config.morphdom.onElUpdated(t)},onNodeAdded:function(t){return e._throttledLoadOrUpdate(),"onNodeAdded"in e._config.morphdom?e._config.morphdom.onNodeAdded(t):t},onNodeDiscarded:function(t){return e._throttledLoadOrUpdate(),"onNodeDiscarded"in e._config.morphdom?e._config.morphdom.onNodeDiscarded(t):t}})):this._throttledLoadOrUpdate()},e.prototype._checkTemplate=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes.length>1?(this._errors=this._errors.concat("ERR002: the root level of your template MUST NOT contain more than one tag. Consider using a single div tag as a wrapper around your template."),this._empty):0===t.children.length?t.childNodes.length>0?(this._errors=this._errors.concat("ERR003: the root level of your template MUST NOT contain a single text node. Consider using a single div tag as a wrapper around your template."),this._empty):this._empty:e},e.prototype._getTemplate=function(e){return"string"==typeof e?e:e instanceof HTMLScriptElement?e.innerHTML:(this._errors=this._errors.concat("ERR004: template must be a string or a script tag element."),"")},e.prototype._getThrottling=function(e){var t=e.split(/\./g),r=t[0];if(t.length>1&&"throttled"===t[1]){if(3===t.length){var n=parseInt(t[2],10);if(!isNaN(n))return{eventName:r,ms:n,throttled:!0};this._warnings=this._warnings.concat('WARN003: event name "'.concat(e,'" is malformed. The milliseconds "').concat(t[2],'" are not a valid number. falling back to request animation frame.'))}return{eventName:r,throttled:!0}}return{eventName:r,throttled:!1}},e.prototype._loadOrUpdate=function(){var e=g(this._state);!1===this._loaded?(this._loaded=!0,this._config.load(e,this._setState.bind(this))):this._config.update(e,this._setState.bind(this))},e.NON_BUBBLING_EVENTS=["abort","blur","error","focus","load","loadend","loadstart","pointerenter","pointerleave","progress","scroll","unload"],e}()}();
